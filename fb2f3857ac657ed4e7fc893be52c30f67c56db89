{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "29e0897e_bb3f9b7e",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 14
      },
      "lineNbr": 0,
      "author": {
        "id": 1000056
      },
      "writtenOn": "2023-06-07T16:18:18Z",
      "side": 1,
      "message": "Also need to check whether ttbr0 (stage 1) and vttbr0 (stage 2) have the bits 50 and 51 programmed correctly",
      "revId": "fb2f3857ac657ed4e7fc893be52c30f67c56db89",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "010ed58b_a478ca7e",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 14
      },
      "lineNbr": 0,
      "author": {
        "id": 1000056
      },
      "writtenOn": "2023-06-07T16:20:27Z",
      "side": 1,
      "message": "Note to self: \nOther items to check : TLBI range instructions usage in RMM\nDo not allow concatenation of tables at level -1 \nTxSZ need appropriate programming based on IPA size and VA size\nCheck whether alignment of concatenated tables match arch specification.",
      "revId": "fb2f3857ac657ed4e7fc893be52c30f67c56db89",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "4e8db20c_d5633e32",
        "filename": "lib/arch/include/arch.h",
        "patchSetId": 14
      },
      "lineNbr": 611,
      "author": {
        "id": 1000056
      },
      "writtenOn": "2023-06-07T16:18:18Z",
      "side": 1,
      "message": "This needs to be SL2 \u003d 1 and SL0 \u003d 00.",
      "range": {
        "startLine": 611,
        "startChar": 8,
        "endLine": 611,
        "endChar": 25
      },
      "revId": "fb2f3857ac657ed4e7fc893be52c30f67c56db89",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "4186ed21_5e07e6ee",
        "filename": "lib/arch/include/arch.h",
        "patchSetId": 14
      },
      "lineNbr": 611,
      "author": {
        "id": 1000298
      },
      "writtenOn": "2023-06-07T17:44:59Z",
      "side": 1,
      "message": "SL2 is not contiguous to SL0 and SL1, so it is setup aside. When LPA2 is enabled and start level is -1, SL0 and SL1 bits coincide with the settings for level 0, hence this definition.",
      "parentUuid": "4e8db20c_d5633e32",
      "range": {
        "startLine": 611,
        "startChar": 8,
        "endLine": 611,
        "endChar": 25
      },
      "revId": "fb2f3857ac657ed4e7fc893be52c30f67c56db89",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "5e755fc8_c87506a6",
        "filename": "lib/arch/include/arch.h",
        "patchSetId": 14
      },
      "lineNbr": 615,
      "author": {
        "id": 1000056
      },
      "writtenOn": "2023-06-07T16:18:18Z",
      "side": 1,
      "message": "We need to set SL2 bit to 1 for Level -1.",
      "revId": "fb2f3857ac657ed4e7fc893be52c30f67c56db89",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "80f8f7af_6d88f6ce",
        "filename": "lib/arch/include/arch.h",
        "patchSetId": 14
      },
      "lineNbr": 615,
      "author": {
        "id": 1000298
      },
      "writtenOn": "2023-06-07T17:44:59Z",
      "side": 1,
      "message": "Bit SL2 is not contiguous to SL0 and SL1, so it is setup aside",
      "parentUuid": "5e755fc8_c87506a6",
      "revId": "fb2f3857ac657ed4e7fc893be52c30f67c56db89",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "860201ad_60222117",
        "filename": "lib/realm/include/table.h",
        "patchSetId": 14
      },
      "lineNbr": 19,
      "author": {
        "id": 1000056
      },
      "writtenOn": "2023-06-07T16:18:18Z",
      "side": 1,
      "message": "Call this RTT_MIN_START_LEVEL",
      "range": {
        "startLine": 19,
        "startChar": 8,
        "endLine": 19,
        "endChar": 27
      },
      "revId": "fb2f3857ac657ed4e7fc893be52c30f67c56db89",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "b4ec15de_192bdb4b",
        "filename": "lib/realm/include/table.h",
        "patchSetId": 14
      },
      "lineNbr": 19,
      "author": {
        "id": 1000298
      },
      "writtenOn": "2023-06-08T14:29:55Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "860201ad_60222117",
      "range": {
        "startLine": 19,
        "startChar": 8,
        "endLine": 19,
        "endChar": 27
      },
      "revId": "fb2f3857ac657ed4e7fc893be52c30f67c56db89",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "053dba17_25a277b9",
        "filename": "lib/realm/src/s2tt.c",
        "patchSetId": 14
      },
      "lineNbr": 32,
      "author": {
        "id": 1000056
      },
      "writtenOn": "2023-06-07T16:18:18Z",
      "side": 1,
      "message": "This define is confusing. Better to abtract the whole OA as a macro together.",
      "revId": "fb2f3857ac657ed4e7fc893be52c30f67c56db89",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "93bf4908_b2158da5",
        "filename": "lib/realm/src/s2tt.c",
        "patchSetId": 14
      },
      "lineNbr": 32,
      "author": {
        "id": 1000298
      },
      "writtenOn": "2023-06-08T14:29:55Z",
      "side": 1,
      "message": "This is actually only used in a static function below, (addr_level_mask()), so it can be done 52, which would make more sense. It was make 50 to cater for the 2 MSBs not be contiguous to the rest of the OA but after some refactoring it didn\u0027t need to be 50 anymore.",
      "parentUuid": "053dba17_25a277b9",
      "revId": "fb2f3857ac657ed4e7fc893be52c30f67c56db89",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "058daa5c_74aee8f9",
        "filename": "lib/realm/src/s2tt.c",
        "patchSetId": 14
      },
      "lineNbr": 44,
      "author": {
        "id": 1000056
      },
      "writtenOn": "2023-06-07T16:18:18Z",
      "side": 1,
      "message": "all extra changes can be made separate patch.",
      "revId": "fb2f3857ac657ed4e7fc893be52c30f67c56db89",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "93ff52ab_602a5135",
        "filename": "lib/realm/src/s2tt.c",
        "patchSetId": 14
      },
      "lineNbr": 44,
      "author": {
        "id": 1000298
      },
      "writtenOn": "2023-06-08T14:29:55Z",
      "side": 1,
      "message": "See my comment below about these changes",
      "parentUuid": "058daa5c_74aee8f9",
      "revId": "fb2f3857ac657ed4e7fc893be52c30f67c56db89",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "a6a9f9cf_202ea967",
        "filename": "lib/realm/src/s2tt.c",
        "patchSetId": 14
      },
      "lineNbr": 86,
      "author": {
        "id": 1000056
      },
      "writtenOn": "2023-06-07T16:18:18Z",
      "side": 1,
      "message": "Define a S2TTE_GET_OA(tte) macro here.",
      "revId": "fb2f3857ac657ed4e7fc893be52c30f67c56db89",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "de8c11d5_e6b7e364",
        "filename": "lib/realm/src/s2tt.c",
        "patchSetId": 14
      },
      "lineNbr": 86,
      "author": {
        "id": 1000298
      },
      "writtenOn": "2023-06-08T14:29:55Z",
      "side": 1,
      "message": "There is actually an inline function for that (which was there before this patch): table_entry_to_phys()",
      "parentUuid": "a6a9f9cf_202ea967",
      "revId": "fb2f3857ac657ed4e7fc893be52c30f67c56db89",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "3074aa53_33ff75fc",
        "filename": "lib/realm/src/s2tt.c",
        "patchSetId": 14
      },
      "lineNbr": 123,
      "author": {
        "id": 1000056
      },
      "writtenOn": "2023-06-07T16:18:18Z",
      "side": 1,
      "message": "For the sake of keeping changes to this file to a min , would prefer these extra changes to be made a separate patch.",
      "revId": "fb2f3857ac657ed4e7fc893be52c30f67c56db89",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "9544eaa6_47ee6732",
        "filename": "lib/realm/src/s2tt.c",
        "patchSetId": 14
      },
      "lineNbr": 123,
      "author": {
        "id": 1000298
      },
      "writtenOn": "2023-06-07T17:44:59Z",
      "side": 1,
      "message": "All this changes are part of the support for LPA2 into s2tte, so I don\u0027t think this changes can be logically separated.",
      "parentUuid": "3074aa53_33ff75fc",
      "revId": "fb2f3857ac657ed4e7fc893be52c30f67c56db89",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "19e89eb0_ce8323d2",
        "filename": "lib/realm/src/s2tt.c",
        "patchSetId": 14
      },
      "lineNbr": 123,
      "author": {
        "id": 1000298
      },
      "writtenOn": "2023-06-08T14:29:55Z",
      "side": 1,
      "message": "I reviewed this more in detail now. I thought these were other changes. Still, if I am not wrong, it was decided at some point that any fixes, that the ones below, that had to be done on a file, they will be done next time the file had to be edited as part of a patch, right? That is the reason why I fixed this here, rather than on a separate patch.",
      "parentUuid": "9544eaa6_47ee6732",
      "revId": "fb2f3857ac657ed4e7fc893be52c30f67c56db89",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "bdd21336_e36bc056",
        "filename": "lib/realm/src/s2tt.c",
        "patchSetId": 14
      },
      "lineNbr": 208,
      "author": {
        "id": 1000056
      },
      "writtenOn": "2023-06-07T16:18:18Z",
      "side": 1,
      "message": "same comments for any unneeded change.",
      "revId": "fb2f3857ac657ed4e7fc893be52c30f67c56db89",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "28d15d8d_922363dc",
        "filename": "lib/realm/src/s2tt.c",
        "patchSetId": 14
      },
      "lineNbr": 208,
      "author": {
        "id": 1000298
      },
      "writtenOn": "2023-06-08T14:29:55Z",
      "side": 1,
      "message": "Some of this lines were over 80 cols. See my comment above about fixing minor existing nits on files.",
      "parentUuid": "bdd21336_e36bc056",
      "revId": "fb2f3857ac657ed4e7fc893be52c30f67c56db89",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "13b65e95_415bde36",
        "filename": "lib/realm/src/s2tt.c",
        "patchSetId": 14
      },
      "lineNbr": 258,
      "author": {
        "id": 1000056
      },
      "writtenOn": "2023-06-07T16:18:18Z",
      "side": 1,
      "message": "define a macro for this.",
      "range": {
        "startLine": 258,
        "startChar": 11,
        "endLine": 258,
        "endChar": 13
      },
      "revId": "fb2f3857ac657ed4e7fc893be52c30f67c56db89",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "2e75d4c4_8d18bee3",
        "filename": "lib/realm/src/s2tt.c",
        "patchSetId": 14
      },
      "lineNbr": 258,
      "author": {
        "id": 1000298
      },
      "writtenOn": "2023-06-08T14:29:55Z",
      "side": 1,
      "message": "I think defining a macro just for this might be bit confusing as this is a corner case? That\u0027s why I added an explanation for that \u00274\u0027 instead.",
      "parentUuid": "13b65e95_415bde36",
      "range": {
        "startLine": 258,
        "startChar": 11,
        "endLine": 258,
        "endChar": 13
      },
      "revId": "fb2f3857ac657ed4e7fc893be52c30f67c56db89",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "9c13236a_89c28bcf",
        "filename": "lib/realm/src/s2tt.c",
        "patchSetId": 14
      },
      "lineNbr": 289,
      "author": {
        "id": 1000056
      },
      "writtenOn": "2023-06-07T16:18:18Z",
      "side": 1,
      "message": "Not sure this will cater to bits 50:51 when LPA2 is enabled.",
      "revId": "fb2f3857ac657ed4e7fc893be52c30f67c56db89",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "564fd533_95060284",
        "filename": "lib/realm/src/s2tt.c",
        "patchSetId": 14
      },
      "lineNbr": 289,
      "author": {
        "id": 1000298
      },
      "writtenOn": "2023-06-08T14:29:55Z",
      "side": 1,
      "message": "Yes it does. S2TTE_OA_BITS is now 52. if level \u003d\u003d -1, then levels \u003d\u003d 4, which makes lsb \u003d\u003d 48. Also, this function is designed to receive an address as the first argument. For the cases in which this function is recycled to receive a tte instead (three instances below, of which I\u0027ve removed two after some refactor), the MSBs are treated independently after this function returns.\n\nIf you think it will make the code clearer, I can add a counterpart to receive a tte instead so it will process the MSBs as well, tte_oa_level_mask() for instance.",
      "parentUuid": "9c13236a_89c28bcf",
      "revId": "fb2f3857ac657ed4e7fc893be52c30f67c56db89",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "3b9ea79e_142eb6af",
        "filename": "lib/realm/src/s2tt.c",
        "patchSetId": 14
      },
      "lineNbr": 297,
      "author": {
        "id": 1000056
      },
      "writtenOn": "2023-06-07T16:18:18Z",
      "side": 1,
      "message": "Use a defined macro for this.",
      "revId": "fb2f3857ac657ed4e7fc893be52c30f67c56db89",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "8f265a9a_aaaab553",
        "filename": "lib/realm/src/s2tt.c",
        "patchSetId": 14
      },
      "lineNbr": 297,
      "author": {
        "id": 1000298
      },
      "writtenOn": "2023-06-08T14:29:55Z",
      "side": 1,
      "message": "I\u0027ve just reworked this and now this is the only point where we do this bit manipulation, so I think a macro now would add a bit more of complexity.",
      "parentUuid": "3b9ea79e_142eb6af",
      "revId": "fb2f3857ac657ed4e7fc893be52c30f67c56db89",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "a1f999fb_8a39a113",
        "filename": "plat/common/src/plat_common_init.c",
        "patchSetId": 14
      },
      "lineNbr": 109,
      "author": {
        "id": 1000056
      },
      "writtenOn": "2023-06-07T16:18:18Z",
      "side": 1,
      "message": "this needs to be a runtime check part of xlat table init.",
      "revId": "fb2f3857ac657ed4e7fc893be52c30f67c56db89",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "4ce1e0d0_52c17607",
        "filename": "plat/common/src/plat_common_init.c",
        "patchSetId": 14
      },
      "lineNbr": 109,
      "author": {
        "id": 1000298
      },
      "writtenOn": "2023-06-07T17:44:59Z",
      "side": 1,
      "message": "This is now a runtime check part of xlat library (when I originally wrote this patch, xlat library supported platforms with and w/o LPA2), still, I think this is necessary as, theoretically, you can have LPA2 support on stage 1 but not on stage 2 and viceversa. This check is specific for stage 2, whereas xlat lib is only concerned with stage 1.",
      "parentUuid": "a1f999fb_8a39a113",
      "revId": "fb2f3857ac657ed4e7fc893be52c30f67c56db89",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "47c55e2d_e697f29e",
        "filename": "runtime/rmi/realm.c",
        "patchSetId": 14
      },
      "lineNbr": 159,
      "author": {
        "id": 1000056
      },
      "writtenOn": "2023-06-07T16:18:18Z",
      "side": 1,
      "message": "The SL2 need to be validated as well",
      "revId": "fb2f3857ac657ed4e7fc893be52c30f67c56db89",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "b412b7cb_32de649f",
        "filename": "runtime/rmi/realm.c",
        "patchSetId": 14
      },
      "lineNbr": 159,
      "author": {
        "id": 1000298
      },
      "writtenOn": "2023-06-07T17:44:59Z",
      "side": 1,
      "message": "This validates the start level passed on the parameters when creating the realm, not the configuration of the SL bits. SL bits are configured based on the start level later, during realm entry.",
      "parentUuid": "47c55e2d_e697f29e",
      "revId": "fb2f3857ac657ed4e7fc893be52c30f67c56db89",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "737cc156_99b60854",
        "filename": "runtime/rmi/rec.c",
        "patchSetId": 14
      },
      "lineNbr": 118,
      "author": {
        "id": 1000056
      },
      "writtenOn": "2023-06-07T16:18:18Z",
      "side": 1,
      "message": "gave a comment for this.",
      "revId": "fb2f3857ac657ed4e7fc893be52c30f67c56db89",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "414e35e1_300ce9cc",
        "filename": "runtime/rmi/rec.c",
        "patchSetId": 14
      },
      "lineNbr": 118,
      "author": {
        "id": 1000298
      },
      "writtenOn": "2023-06-07T17:44:59Z",
      "side": 1,
      "message": "SL0 and SL1, are setup on line 116 (sl0, which actually contains [SL0:SL1] is setup on line 109). SL2 is not contiguous to them, so it has to be setup on its own, to \u00271\u0027 when the start level \u003d\u003d -1.",
      "parentUuid": "737cc156_99b60854",
      "revId": "fb2f3857ac657ed4e7fc893be52c30f67c56db89",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    }
  ]
}