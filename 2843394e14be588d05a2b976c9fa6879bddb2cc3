{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "203c3c3e_d0ec14be",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 14
      },
      "lineNbr": 0,
      "author": {
        "id": 1000056
      },
      "writtenOn": "2023-09-12T11:06:23Z",
      "side": 1,
      "message": "Thanks Raghu for the comments. Will wait Javier to rework the comments.",
      "revId": "2843394e14be588d05a2b976c9fa6879bddb2cc3",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e2084cf7_99c84fdf",
        "filename": "docs/security/threat_model/threat_analysis.rst",
        "patchSetId": 14
      },
      "lineNbr": 33,
      "author": {
        "id": 1000114
      },
      "writtenOn": "2023-09-12T01:47:54Z",
      "side": 1,
      "message": "not sure if code execution is an asset. For the RMM, really its assets are its own code and data so do you really mean Sensitive/RMM code, as opposed to \"execution\"? \nYou can apply STRIDE on code, not sure how you apply it on code execution, which is really a threat as opposed to an asset.\nLet me know if you disagree.",
      "range": {
        "startLine": 33,
        "startChar": 4,
        "endLine": 33,
        "endChar": 18
      },
      "revId": "2843394e14be588d05a2b976c9fa6879bddb2cc3",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "39563844_ab57b088",
        "filename": "docs/security/threat_model/threat_analysis.rst",
        "patchSetId": 14
      },
      "lineNbr": 33,
      "author": {
        "id": 1000298
      },
      "writtenOn": "2023-09-12T10:01:26Z",
      "side": 1,
      "message": "If the code execution were altered (e.g. through JOP/ROP attacks) the system would be compromised, which is why we consider the Code Execution as an asset to protect. Additionally, RMM must protect the Realms, avoiding any escalation of privileges or altering the execution flow through the RMI/RSI, which is also covered by this asset.",
      "parentUuid": "e2084cf7_99c84fdf",
      "range": {
        "startLine": 33,
        "startChar": 4,
        "endLine": 33,
        "endChar": 18
      },
      "revId": "2843394e14be588d05a2b976c9fa6879bddb2cc3",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "27b8773a_7c4a5738",
        "filename": "docs/security/threat_model/threat_analysis.rst",
        "patchSetId": 14
      },
      "lineNbr": 33,
      "author": {
        "id": 1000056
      },
      "writtenOn": "2023-09-12T11:05:58Z",
      "side": 1,
      "message": "Javier has explained it , but will post the answer since I had this typed already. \n\n\nMy take is that this is considering the control flow associated with code execution is considered an asset and also the execution should take place at the right exception level.\n\nThe RMM needs to protect both RMM and Realm code execution.\n\nFor the Realm, it should not be possible for NS Host to change code execution or decipher the exact  value of PC.\n\nSimilarly, Realms should not be able to break out of EL1 exception level and cause Realm code to execute with R-EL2 privileges.",
      "parentUuid": "39563844_ab57b088",
      "range": {
        "startLine": 33,
        "startChar": 4,
        "endLine": 33,
        "endChar": 18
      },
      "revId": "2843394e14be588d05a2b976c9fa6879bddb2cc3",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "05387f07_5f20444c",
        "filename": "docs/security/threat_model/threat_analysis.rst",
        "patchSetId": 14
      },
      "lineNbr": 33,
      "author": {
        "id": 1000114
      },
      "writtenOn": "2023-09-14T15:30:14Z",
      "side": 1,
      "message": "Hi Soby, Javier, thanks. I agree with what you say above, however, i still dont think code execution of RMM is an asset. An asset is something that you want to protect, not leak (like data, code) and has value to an attacker. Arbitrary Code execution, by itself has no value, if you cannot do anything with it (for ex, if no realms run, code execution on RMM is useless). An attacker uses arbitrary code execution to break realm code execution (get NS to change PC as mentioned above) or a malicious realm uses arbitrary code execution in RMM to break out of EL1 exception, to attack another realm or RMM data. Yet again, the asset in those examples are not the RMM Code execution itself, it is the RMM or other realms data.\nSo RMM code execution is the means to an end to attack a real asset, since by itself, it has no value.\n\nLet me know what you think.",
      "parentUuid": "27b8773a_7c4a5738",
      "range": {
        "startLine": 33,
        "startChar": 4,
        "endLine": 33,
        "endChar": 18
      },
      "revId": "2843394e14be588d05a2b976c9fa6879bddb2cc3",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "63d02065_070c8b9a",
        "filename": "docs/security/threat_model/threat_analysis.rst",
        "patchSetId": 14
      },
      "lineNbr": 33,
      "author": {
        "id": 1000056
      },
      "writtenOn": "2023-09-15T14:15:07Z",
      "side": 1,
      "message": "Some of this subjective and open to interpretation.\n\nIf we know that code execution can be subverted to break realm code execution, then we can consider the RMM/Realm \"execution\" itself is a property that needs to be protection against tampering/subversion by adversary. From that PoV, it can be treated as a logical asset which needs protection from threats and needs covering in the threat model IMO.",
      "parentUuid": "05387f07_5f20444c",
      "range": {
        "startLine": 33,
        "startChar": 4,
        "endLine": 33,
        "endChar": 18
      },
      "revId": "2843394e14be588d05a2b976c9fa6879bddb2cc3",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "0fc81047_6853096e",
        "filename": "docs/security/threat_model/threat_analysis.rst",
        "patchSetId": 14
      },
      "lineNbr": 33,
      "author": {
        "id": 1000114
      },
      "writtenOn": "2023-09-15T14:47:04Z",
      "side": 1,
      "message": "right but as I said, it has no value to the attacker if they can’t use it to get anything of value. perhaps RAK is one of those assets that you can break down it’s just code execution so I suppose I agree.",
      "parentUuid": "63d02065_070c8b9a",
      "range": {
        "startLine": 33,
        "startChar": 4,
        "endLine": 33,
        "endChar": 18
      },
      "revId": "2843394e14be588d05a2b976c9fa6879bddb2cc3",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "41eaffbf_9f44a5be",
        "filename": "docs/security/threat_model/threat_analysis.rst",
        "patchSetId": 14
      },
      "lineNbr": 33,
      "author": {
        "id": 1000056
      },
      "writtenOn": "2023-09-15T15:09:24Z",
      "side": 1,
      "message": "Ok, Thanks, I have made a small reword to this effect.",
      "parentUuid": "0fc81047_6853096e",
      "range": {
        "startLine": 33,
        "startChar": 4,
        "endLine": 33,
        "endChar": 18
      },
      "revId": "2843394e14be588d05a2b976c9fa6879bddb2cc3",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "b7b54c95_bbf0942b",
        "filename": "docs/security/threat_model/threat_analysis.rst",
        "patchSetId": 14
      },
      "lineNbr": 33,
      "author": {
        "id": 1000114
      },
      "writtenOn": "2023-09-15T17:13:21Z",
      "side": 1,
      "message": "mild suggestion but maybe call the logical asset rmm control flow as opposed to code execution ? can relate it to control flow integrity where we prevent control flow “tampering” .",
      "parentUuid": "41eaffbf_9f44a5be",
      "range": {
        "startLine": 33,
        "startChar": 4,
        "endLine": 33,
        "endChar": 18
      },
      "revId": "2843394e14be588d05a2b976c9fa6879bddb2cc3",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "c0856b30_093a5f48",
        "filename": "docs/security/threat_model/threat_analysis.rst",
        "patchSetId": 14
      },
      "lineNbr": 33,
      "author": {
        "id": 1000056
      },
      "writtenOn": "2023-09-18T08:36:35Z",
      "side": 1,
      "message": "For me, \"rmm control flow\" does not cover aspects like privilege escalation and code injection attacks.  Although \"code execution\" is a very broad term, given the description here, this may work for the purposes.",
      "parentUuid": "b7b54c95_bbf0942b",
      "range": {
        "startLine": 33,
        "startChar": 4,
        "endLine": 33,
        "endChar": 18
      },
      "revId": "2843394e14be588d05a2b976c9fa6879bddb2cc3",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "b1d1bc09_bb030925",
        "filename": "docs/security/threat_model/threat_analysis.rst",
        "patchSetId": 14
      },
      "lineNbr": 33,
      "author": {
        "id": 1000114
      },
      "writtenOn": "2023-09-18T14:42:25Z",
      "side": 1,
      "message": "right, thats one of the reasons why i was saying code execution barely makes sense as a logical asset, since it is a means to an end for the attacker, not something that is valuable to the attacker by itself.\nOut of curiosity, why wouldnt control flow cover privilege escalation or code injection? are you thinkin of attacks where an attacker is able to add a page into the RMM and map it as executable?\n\nI would also be curious to see if you have other threat models where code execution is considered an asset. Would like to see how/what context that has been used in.",
      "parentUuid": "c0856b30_093a5f48",
      "range": {
        "startLine": 33,
        "startChar": 4,
        "endLine": 33,
        "endChar": 18
      },
      "revId": "2843394e14be588d05a2b976c9fa6879bddb2cc3",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "f7cdcee7_1b964167",
        "filename": "docs/security/threat_model/threat_analysis.rst",
        "patchSetId": 14
      },
      "lineNbr": 33,
      "author": {
        "id": 1000056
      },
      "writtenOn": "2023-09-18T15:32:30Z",
      "side": 1,
      "message": "For the realms yes, there is a possibility that Realm code memory can be remapped to a different PA without any change in the caller control flow. If RMM ABI does not actively put in measures to mitigate such attacks, then this is a very viable threat.\n\nAlso if Realms or NS host is able to trigger vulnerability in RMM which allows realm code to execute in R-EL2 (example: RMM not setting up control registers correctly and eret-ing to Realm world with target EL \u003d EL2), this again may not involve a direct change of control flow. \n\nIntegrity of execution of code within realms without interference from NS hypervisor is one of the guarantees of Arm CCA which then implicitly makes it an asset for RMM to protect against attackers.\n\nThe TF-A threat model also lists \"code execution\" as an asset although for a different purpose. Not sure about the hafnium one though.",
      "parentUuid": "b1d1bc09_bb030925",
      "range": {
        "startLine": 33,
        "startChar": 4,
        "endLine": 33,
        "endChar": 18
      },
      "revId": "2843394e14be588d05a2b976c9fa6879bddb2cc3",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "b41e57cc_cc0746d6",
        "filename": "docs/security/threat_model/threat_analysis.rst",
        "patchSetId": 14
      },
      "lineNbr": 43,
      "author": {
        "id": 1000114
      },
      "writtenOn": "2023-09-12T01:56:59Z",
      "side": 1,
      "message": "again, not sure this is an RMM asset. IIUC, we are threat modeling the RMM so the assets really are only code and data.",
      "range": {
        "startLine": 43,
        "startChar": 4,
        "endLine": 43,
        "endChar": 16
      },
      "revId": "2843394e14be588d05a2b976c9fa6879bddb2cc3",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "2d73115e_118144a5",
        "filename": "docs/security/threat_model/threat_analysis.rst",
        "patchSetId": 14
      },
      "lineNbr": 43,
      "author": {
        "id": 1000298
      },
      "writtenOn": "2023-09-12T10:01:26Z",
      "side": 1,
      "message": "This TM takes into consideration threats such as denial-of-service attacks, which would make RMM unavailable and, by extension, any other software running in the Realm space, which is why we consider Availability as an asset to protect as well.",
      "parentUuid": "b41e57cc_cc0746d6",
      "range": {
        "startLine": 43,
        "startChar": 4,
        "endLine": 43,
        "endChar": 16
      },
      "revId": "2843394e14be588d05a2b976c9fa6879bddb2cc3",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "f0812d3b_f7ce4508",
        "filename": "docs/security/threat_model/threat_analysis.rst",
        "patchSetId": 14
      },
      "lineNbr": 43,
      "author": {
        "id": 1000056
      },
      "writtenOn": "2023-09-12T11:05:58Z",
      "side": 1,
      "message": "The asset is that the \"availability of the system\" (NS, secure world) should not be affected by Realms/RMM.\n\nAt an implementation level, it means that RMM should allow NS and Secure events to pre-empt Realms. Similarly, RMM should be designed in such a way that any long running operations in RMM do not cause starvation issues for the NS world. Also any crash/hang of Realm world should not affect availability of Secure world.",
      "parentUuid": "2d73115e_118144a5",
      "range": {
        "startLine": 43,
        "startChar": 4,
        "endLine": 43,
        "endChar": 16
      },
      "revId": "2843394e14be588d05a2b976c9fa6879bddb2cc3",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "5c4e1f44_455a179f",
        "filename": "docs/security/threat_model/threat_analysis.rst",
        "patchSetId": 14
      },
      "lineNbr": 43,
      "author": {
        "id": 1000298
      },
      "writtenOn": "2023-09-12T12:35:41Z",
      "side": 1,
      "message": "Actually Soby gave a better explanation than I did, as I was only thinking on the Realm world (which is out of the scope for the TM, as this asset description states)",
      "parentUuid": "f0812d3b_f7ce4508",
      "range": {
        "startLine": 43,
        "startChar": 4,
        "endLine": 43,
        "endChar": 16
      },
      "revId": "2843394e14be588d05a2b976c9fa6879bddb2cc3",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "4a0ccfab_18b5e597",
        "filename": "docs/security/threat_model/threat_analysis.rst",
        "patchSetId": 14
      },
      "lineNbr": 43,
      "author": {
        "id": 1000114
      },
      "writtenOn": "2023-09-14T15:30:14Z",
      "side": 1,
      "message": "Hi Soby, Javier, so the threat model says the target of evaluation is the RMM, but it sounds like the asset here is \"availability of the system\". Availability of system would make sense if we were threat modeling the system (i.e system is the target of evaluation). By itself, afaik, RMM provides no availability guarantees to the realms (as stated) or the system, or even NS world. A crash or hang is really a bug. The RMM is a passive entity, that simply responds to command from realms or NS world or S world, and only provides isolation guarantees between realms (let me know if you think that understanding is incorrect).\nGiven that the RMM is the target of evaluation, the assumption is RMM isnt malicous (it is the target of attack), so really, what you are probably thinking of is realms or NS doing somethng (such as causing state machine or data changes in RMM) that causes the RMM to hang or crash. Again, the availability of the system is not the RMMs asset, it is a system level asset, and the RMM can influence/affect that, if we are doing a system level threat model.\nIf RMM is the TOE, i dont think system availability should be part of it. That sounds more like it should be part of ARM CCA threat model.",
      "parentUuid": "5c4e1f44_455a179f",
      "range": {
        "startLine": 43,
        "startChar": 4,
        "endLine": 43,
        "endChar": 16
      },
      "revId": "2843394e14be588d05a2b976c9fa6879bddb2cc3",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "490a15a4_bc2ab387",
        "filename": "docs/security/threat_model/threat_analysis.rst",
        "patchSetId": 14
      },
      "lineNbr": 43,
      "author": {
        "id": 1000056
      },
      "writtenOn": "2023-09-15T14:15:07Z",
      "side": 1,
      "message": "Hmm, yes, probably you are right that this belongs better in system threat model. But there is no such system threat model and there are many mitigations that need to be taken by RMM so as to avoid affect the system availability.\n\nAnother angle to treat this is, RMM is part of system Root Trust Base (which includes EL3 root monitor) and is considered system software, so system considerations are part of overall RMM design and security objectives. This is a good incentive for the RMM threat model to consider those system aspects as well and ensure suitable mitigations are in place within this Threat model. So in my opinion, it is better to cover those threats here in this threat model even if it means there will be duplication in another system threat model (if it will exist).",
      "parentUuid": "4a0ccfab_18b5e597",
      "range": {
        "startLine": 43,
        "startChar": 4,
        "endLine": 43,
        "endChar": 16
      },
      "revId": "2843394e14be588d05a2b976c9fa6879bddb2cc3",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "67cec511_a41ceb4e",
        "filename": "docs/security/threat_model/threat_analysis.rst",
        "patchSetId": 14
      },
      "lineNbr": 43,
      "author": {
        "id": 1000114
      },
      "writtenOn": "2023-09-15T14:47:04Z",
      "side": 1,
      "message": "thanks Soby, sure, that’s fine then it would be good to update the target of evaluation to say it is really the rmm implementation in a typical system context. if we don’t say that the documented threats don’t read cohesively at least to me. will resolve comment assuming we want to say that, no issues if you don’t think it is necessary.",
      "parentUuid": "490a15a4_bc2ab387",
      "range": {
        "startLine": 43,
        "startChar": 4,
        "endLine": 43,
        "endChar": 16
      },
      "revId": "2843394e14be588d05a2b976c9fa6879bddb2cc3",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "082a2a23_3ce3bd31",
        "filename": "docs/security/threat_model/threat_analysis.rst",
        "patchSetId": 14
      },
      "lineNbr": 69,
      "author": {
        "id": 1000114
      },
      "writtenOn": "2023-09-12T01:56:59Z",
      "side": 1,
      "message": "not sure i agree this is a valid threat agent since RMM is the target of evaluation. It is not interesting how the target of evaluation can attack itself, but really how others can break the guarantees provided by the TOE..",
      "range": {
        "startLine": 69,
        "startChar": 6,
        "endLine": 69,
        "endChar": 13
      },
      "revId": "2843394e14be588d05a2b976c9fa6879bddb2cc3",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "babf5f7f_8cf4988a",
        "filename": "docs/security/threat_model/threat_analysis.rst",
        "patchSetId": 14
      },
      "lineNbr": 69,
      "author": {
        "id": 1000298
      },
      "writtenOn": "2023-09-12T10:01:26Z",
      "side": 1,
      "message": "The target of evaluation cannot attack itself, directly, but the Threat Model keeps into account bugs and flaws that can be present in the code and can be exploited and how we mitigate those (e.g. by performing static analysis on the code and running tests on it).",
      "parentUuid": "082a2a23_3ce3bd31",
      "range": {
        "startLine": 69,
        "startChar": 6,
        "endLine": 69,
        "endChar": 13
      },
      "revId": "2843394e14be588d05a2b976c9fa6879bddb2cc3",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "b3cba8c6_11ba1a4f",
        "filename": "docs/security/threat_model/threat_analysis.rst",
        "patchSetId": 14
      },
      "lineNbr": 69,
      "author": {
        "id": 1000298
      },
      "writtenOn": "2023-09-12T14:44:42Z",
      "side": 1,
      "message": "I added some rewording here.",
      "parentUuid": "babf5f7f_8cf4988a",
      "range": {
        "startLine": 69,
        "startChar": 6,
        "endLine": 69,
        "endChar": 13
      },
      "revId": "2843394e14be588d05a2b976c9fa6879bddb2cc3",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "ceddbf6e_4733ec0e",
        "filename": "docs/security/threat_model/threat_analysis.rst",
        "patchSetId": 14
      },
      "lineNbr": 192,
      "author": {
        "id": 1000114
      },
      "writtenOn": "2023-09-12T01:56:59Z",
      "side": 1,
      "message": "this is changing very fast :)",
      "range": {
        "startLine": 192,
        "startChar": 13,
        "endLine": 192,
        "endChar": 63
      },
      "revId": "2843394e14be588d05a2b976c9fa6879bddb2cc3",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "b8e0e798_4e6e339c",
        "filename": "docs/security/threat_model/threat_analysis.rst",
        "patchSetId": 14
      },
      "lineNbr": 192,
      "author": {
        "id": 1000298
      },
      "writtenOn": "2023-09-12T10:01:26Z",
      "side": 1,
      "message": "Yeah, we didn\u0027t think it was impossible, but for now, unlikely :)",
      "parentUuid": "ceddbf6e_4733ec0e",
      "range": {
        "startLine": 192,
        "startChar": 13,
        "endLine": 192,
        "endChar": 63
      },
      "revId": "2843394e14be588d05a2b976c9fa6879bddb2cc3",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "2f95936e_4deb1304",
        "filename": "docs/security/threat_model/threat_analysis.rst",
        "patchSetId": 14
      },
      "lineNbr": 192,
      "author": {
        "id": 1000114
      },
      "writtenOn": "2023-09-14T15:30:14Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "b8e0e798_4e6e339c",
      "range": {
        "startLine": 192,
        "startChar": 13,
        "endLine": 192,
        "endChar": 63
      },
      "revId": "2843394e14be588d05a2b976c9fa6879bddb2cc3",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e34ed6ef_aa119e2b",
        "filename": "docs/security/threat_model/threat_assessment.rst",
        "patchSetId": 14
      },
      "lineNbr": 154,
      "author": {
        "id": 1000114
      },
      "writtenOn": "2023-09-12T03:18:57Z",
      "side": 1,
      "message": "Not sure i follow how this is an attack on the RMM. I dont think RMM availability is an asset of the RMM. Availability in CCA is entirely dependent on NS world so not sure this threat applies.\nIn my mind RMM has no availability attribute since it is purely a reactive agent and nobody depends on it to be available. It is either available if called, or not if not called upon.\nThe way you crash the RMM is by attempting to exploit code or affect integrity of data for example by trying to call the RMM in unintended ways to cause attacks. Those are nto availability attacks but attacks on code or data via tampering..",
      "range": {
        "startLine": 151,
        "startChar": 28,
        "endLine": 154,
        "endChar": 42
      },
      "revId": "2843394e14be588d05a2b976c9fa6879bddb2cc3",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "a92d21b5_9876865b",
        "filename": "docs/security/threat_model/threat_assessment.rst",
        "patchSetId": 14
      },
      "lineNbr": 154,
      "author": {
        "id": 1000298
      },
      "writtenOn": "2023-09-12T10:01:26Z",
      "side": 1,
      "message": "One of the scenarios we contemplate here, would be for instance if an agent were able to attack RMM in a way in which it would make it enter in a deadlock. In that case, the current CPU could become unavailable, so even though RMM is a reactive agent, it can potentially cause starvation on the rest of the system. Moreover, Realms also request services from RMM. If the latter were unavailable for any reason, the former could become unavailable as well or run into other error conditions if RMM cannot provide requested services.\n\nWe also kept into account, as you rightfully pointed out, that the way of crashing RMM is by attempting to exploit code or affecting integrity of data and that those are code attacks via tampering. However, as we consider \"Availability\" itself as an asset to protect, we decided to include this specific threat to bring the attention to this type of attacks to the Availability asset, even though it can be thought as an indirect threat derived from others, as well as to bring the attention to its specific mitigations.",
      "parentUuid": "e34ed6ef_aa119e2b",
      "range": {
        "startLine": 151,
        "startChar": 28,
        "endLine": 154,
        "endChar": 42
      },
      "revId": "2843394e14be588d05a2b976c9fa6879bddb2cc3",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "360f39bd_383b0b8b",
        "filename": "docs/security/threat_model/threat_assessment.rst",
        "patchSetId": 14
      },
      "lineNbr": 154,
      "author": {
        "id": 1000114
      },
      "writtenOn": "2023-09-14T15:30:14Z",
      "side": 1,
      "message": "Same as other comment. Availability of the system makes sense if the target of evaluation is the system, but my understanding is we want to threat model the RMM (as the data flow diagrams show and i think one of the statements in the rst files).\nFor the scenario you mention, where NS or realm can cause deadlock in the RMM, the asset in question is RMM code/data again, since the attacker is trying to cause state machine or data changes in the RMM, or attack RMM code to make RMM (the threat). The vulnerability in the RMM would be poor/buggy locking design and the consequence/impact of the attack is the RMM crashes.\nYes, it does can cause availability at a system level, but i did not think that is what we are modeling. If the TOE is RMM, i think the threat model should answer what threats are applicable to the RMM, using what vulnerabilities in the RMM code, and what impact it causes to the RMM implementation in question (in this case just the crash).\nLet me know if that distinction makes sense, happy to explain in a phone convo too if needed. If we do a system level threat model, i think ARM CCA threat model covers those anyway..",
      "parentUuid": "a92d21b5_9876865b",
      "range": {
        "startLine": 151,
        "startChar": 28,
        "endLine": 154,
        "endChar": 42
      },
      "revId": "2843394e14be588d05a2b976c9fa6879bddb2cc3",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "bad9e18b_5578bde0",
        "filename": "docs/security/threat_model/threat_assessment.rst",
        "patchSetId": 14
      },
      "lineNbr": 154,
      "author": {
        "id": 1000056
      },
      "writtenOn": "2023-09-15T14:15:07Z",
      "side": 1,
      "message": "As I mentioned in a previous comment, we do not have system level threat model which covers the details of the firmware implementation and there are mitigations specific to RMM implementation for these threats. \n\nIn addition,\nI also consider that interaction with RMM/Realms affecting lower privileged worlds (like NS world) is violation of contract that RMM has with those worlds. It does not run in isolation within the system and is part system firmware. At the risk of duplication in another system threat model, it is better that RMM threat model acknowledges these interactions and lists suitable mitigations here.",
      "parentUuid": "360f39bd_383b0b8b",
      "range": {
        "startLine": 151,
        "startChar": 28,
        "endLine": 154,
        "endChar": 42
      },
      "revId": "2843394e14be588d05a2b976c9fa6879bddb2cc3",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "5b1f9726_7261a786",
        "filename": "docs/security/threat_model/threat_assessment.rst",
        "patchSetId": 14
      },
      "lineNbr": 154,
      "author": {
        "id": 1000114
      },
      "writtenOn": "2023-09-15T14:47:39Z",
      "side": 1,
      "message": "Ack",
      "parentUuid": "bad9e18b_5578bde0",
      "range": {
        "startLine": 151,
        "startChar": 28,
        "endLine": 154,
        "endChar": 42
      },
      "revId": "2843394e14be588d05a2b976c9fa6879bddb2cc3",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "21616d01_5e04f0fa",
        "filename": "docs/security/threat_model/threat_assessment.rst",
        "patchSetId": 14
      },
      "lineNbr": 263,
      "author": {
        "id": 1000114
      },
      "writtenOn": "2023-09-12T03:18:57Z",
      "side": 1,
      "message": "dont agree this affects availability as stated above.",
      "range": {
        "startLine": 263,
        "startChar": 27,
        "endLine": 263,
        "endChar": 39
      },
      "revId": "2843394e14be588d05a2b976c9fa6879bddb2cc3",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "f5613094_0f8f4b63",
        "filename": "docs/security/threat_model/threat_assessment.rst",
        "patchSetId": 14
      },
      "lineNbr": 263,
      "author": {
        "id": 1000298
      },
      "writtenOn": "2023-09-12T10:01:26Z",
      "side": 1,
      "message": "In this context, the Availability asset can be compromised if one of the SMC calls stated above causes the system (or RMM) to crash. Although after re-reading this, it would probably be possible to expand the Threat description on ID03. I will give it some thought",
      "parentUuid": "21616d01_5e04f0fa",
      "range": {
        "startLine": 263,
        "startChar": 27,
        "endLine": 263,
        "endChar": 39
      },
      "revId": "2843394e14be588d05a2b976c9fa6879bddb2cc3",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "d3372d96_74369dd6",
        "filename": "docs/security/threat_model/threat_assessment.rst",
        "patchSetId": 14
      },
      "lineNbr": 263,
      "author": {
        "id": 1000298
      },
      "writtenOn": "2023-09-12T14:44:42Z",
      "side": 1,
      "message": "Removed Availability as suggested. It is actually covered by ID3",
      "parentUuid": "f5613094_0f8f4b63",
      "range": {
        "startLine": 263,
        "startChar": 27,
        "endLine": 263,
        "endChar": 39
      },
      "revId": "2843394e14be588d05a2b976c9fa6879bddb2cc3",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "38ae9e5d_1a0c04a2",
        "filename": "docs/security/threat_model/threat_assessment.rst",
        "patchSetId": 14
      },
      "lineNbr": 297,
      "author": {
        "id": 1000114
      },
      "writtenOn": "2023-09-12T03:18:57Z",
      "side": 1,
      "message": "this is a \"vulnerability\" as opposed to a threat. The threat is that attacker attempts to cause data corruption or deadlocks/livelocks using the RMM ABIs. The vulenrability is that concurrent sections are not implemented correction.",
      "range": {
        "startLine": 297,
        "startChar": 29,
        "endLine": 297,
        "endChar": 52
      },
      "revId": "2843394e14be588d05a2b976c9fa6879bddb2cc3",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "3a371f6e_724f44ee",
        "filename": "docs/security/threat_model/threat_assessment.rst",
        "patchSetId": 14
      },
      "lineNbr": 297,
      "author": {
        "id": 1000298
      },
      "writtenOn": "2023-09-12T10:01:26Z",
      "side": 1,
      "message": "The threat is data corruption or dead/live locks due to incorrect implementation of concurrent sections (which can be exploited by an attacker or cause malfunctions on its own).\n\nI think this description needs rewording. I\u0027ll fix it.",
      "parentUuid": "38ae9e5d_1a0c04a2",
      "range": {
        "startLine": 297,
        "startChar": 29,
        "endLine": 297,
        "endChar": 52
      },
      "revId": "2843394e14be588d05a2b976c9fa6879bddb2cc3",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "78b69324_ff6a632b",
        "filename": "docs/security/threat_model/threat_assessment.rst",
        "patchSetId": 14
      },
      "lineNbr": 297,
      "author": {
        "id": 1000298
      },
      "writtenOn": "2023-09-12T14:44:42Z",
      "side": 1,
      "message": "Reworded",
      "parentUuid": "3a371f6e_724f44ee",
      "range": {
        "startLine": 297,
        "startChar": 29,
        "endLine": 297,
        "endChar": 52
      },
      "revId": "2843394e14be588d05a2b976c9fa6879bddb2cc3",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "3dc9fa63_d3cbde8f",
        "filename": "docs/security/threat_model/threat_assessment.rst",
        "patchSetId": 14
      },
      "lineNbr": 382,
      "author": {
        "id": 1000114
      },
      "writtenOn": "2023-09-12T03:18:57Z",
      "side": 1,
      "message": "not sure this is a threat (something that an attacker would try to do) like above. This is just an implementation bug. I think of threat as something threat agents attempt to do. RealmCode for example can exploit memory corruption (vulnerability), but not \"try to do memory corruption\". The threat is attacker attempting to attack the asset (code), via the vulnerability that is memory corruption/overflows, and the consequence is code execution.",
      "range": {
        "startLine": 382,
        "startChar": 29,
        "endLine": 382,
        "endChar": 38
      },
      "revId": "2843394e14be588d05a2b976c9fa6879bddb2cc3",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "53db99e2_86e9cde4",
        "filename": "docs/security/threat_model/threat_assessment.rst",
        "patchSetId": 14
      },
      "lineNbr": 382,
      "author": {
        "id": 1000298
      },
      "writtenOn": "2023-09-12T10:01:26Z",
      "side": 1,
      "message": "Yes, I agree with you. The threat here is not the memory corruption per-se, mostly that it allows an adversary to put together an attack exploiting such vulnerability.\n\nAs with the previous threat you mentioned, I think that this might need some reword. I will fix it.",
      "parentUuid": "3dc9fa63_d3cbde8f",
      "range": {
        "startLine": 382,
        "startChar": 29,
        "endLine": 382,
        "endChar": 38
      },
      "revId": "2843394e14be588d05a2b976c9fa6879bddb2cc3",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "e95ce124_8a198b80",
        "filename": "docs/security/threat_model/threat_assessment.rst",
        "patchSetId": 14
      },
      "lineNbr": 382,
      "author": {
        "id": 1000298
      },
      "writtenOn": "2023-09-12T14:44:42Z",
      "side": 1,
      "message": "Reworded",
      "parentUuid": "53db99e2_86e9cde4",
      "range": {
        "startLine": 382,
        "startChar": 29,
        "endLine": 382,
        "endChar": 38
      },
      "revId": "2843394e14be588d05a2b976c9fa6879bddb2cc3",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "69e731d7_7229168e",
        "filename": "docs/security/threat_model/threat_assessment.rst",
        "patchSetId": 14
      },
      "lineNbr": 530,
      "author": {
        "id": 1000114
      },
      "writtenOn": "2023-09-12T03:18:57Z",
      "side": 1,
      "message": "dont believe the RMM promises to protect NS host memory, does it? IF NS incorrectly allows this, dont think the RMM is responsible ?",
      "range": {
        "startLine": 530,
        "startChar": 45,
        "endLine": 530,
        "endChar": 64
      },
      "revId": "2843394e14be588d05a2b976c9fa6879bddb2cc3",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "6baa26f0_3b38ec6f",
        "filename": "docs/security/threat_model/threat_assessment.rst",
        "patchSetId": 14
      },
      "lineNbr": 530,
      "author": {
        "id": 1000298
      },
      "writtenOn": "2023-09-12T10:01:26Z",
      "side": 1,
      "message": "Yes, you are right. This needs to be removed",
      "parentUuid": "69e731d7_7229168e",
      "range": {
        "startLine": 530,
        "startChar": 45,
        "endLine": 530,
        "endChar": 64
      },
      "revId": "2843394e14be588d05a2b976c9fa6879bddb2cc3",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "a0ae9e29_98bc6243",
        "filename": "docs/security/threat_model/threat_assessment.rst",
        "patchSetId": 14
      },
      "lineNbr": 530,
      "author": {
        "id": 1000056
      },
      "writtenOn": "2023-09-12T11:05:58Z",
      "side": 1,
      "message": "RMM is responsible for the S2 table programming. So , it is possible that RMM ends up mapping some NS memory (due to incorrect implementation) which the NS has not allowed or maps it with incorrect attributes which may lead to memory model issues for NS when NS is accessing it. It also possible that RMM has not done all the right S2/TLB invalidations in which a NS VM can cause issues for another NS VM via Realm world (this is assuming both the NS VMs have distinct counterpart Realm VMs).\n\nIn that way, a vulnerability in S2 table mapping code in RMM is potentially a threat to NS world as well. Perhaps it needs some rewording to clarify this aspect.",
      "parentUuid": "6baa26f0_3b38ec6f",
      "range": {
        "startLine": 530,
        "startChar": 45,
        "endLine": 530,
        "endChar": 64
      },
      "revId": "2843394e14be588d05a2b976c9fa6879bddb2cc3",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "d548f53a_3fbfccd4",
        "filename": "docs/security/threat_model/threat_assessment.rst",
        "patchSetId": 14
      },
      "lineNbr": 530,
      "author": {
        "id": 1000298
      },
      "writtenOn": "2023-09-12T12:35:41Z",
      "side": 1,
      "message": "Yes, Soby is right, rather than remove the statement, that needs to be reworded so the background for it can be understood. I will implement the changes",
      "parentUuid": "a0ae9e29_98bc6243",
      "range": {
        "startLine": 530,
        "startChar": 45,
        "endLine": 530,
        "endChar": 64
      },
      "revId": "2843394e14be588d05a2b976c9fa6879bddb2cc3",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "b144d951_5c569c9a",
        "filename": "docs/security/threat_model/threat_assessment.rst",
        "patchSetId": 14
      },
      "lineNbr": 530,
      "author": {
        "id": 1000298
      },
      "writtenOn": "2023-09-12T14:44:42Z",
      "side": 1,
      "message": "Reworded.",
      "parentUuid": "d548f53a_3fbfccd4",
      "range": {
        "startLine": 530,
        "startChar": 45,
        "endLine": 530,
        "endChar": 64
      },
      "revId": "2843394e14be588d05a2b976c9fa6879bddb2cc3",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "97b2cb9b_43f23c40",
        "filename": "docs/security/threat_model/threat_assessment.rst",
        "patchSetId": 14
      },
      "lineNbr": 671,
      "author": {
        "id": 1000114
      },
      "writtenOn": "2023-09-12T03:18:57Z",
      "side": 1,
      "message": "dont believe the threat agent is rmm code itself. it is the TOE. IMO, the threat is the a attacker is trying to access RMM data, and the vulnerability used is misconfiguration and the consequence of the attack is data leaks or incorrect behavior.\nThe threat agent is really host software or realm..",
      "range": {
        "startLine": 671,
        "startChar": 27,
        "endLine": 671,
        "endChar": 34
      },
      "revId": "2843394e14be588d05a2b976c9fa6879bddb2cc3",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "d43f9adf_e1a272bf",
        "filename": "docs/security/threat_model/threat_assessment.rst",
        "patchSetId": 14
      },
      "lineNbr": 671,
      "author": {
        "id": 1000298
      },
      "writtenOn": "2023-09-12T10:01:26Z",
      "side": 1,
      "message": "Yes, you are right. RMMCode is not the threat agent, but the one causing the vulnerability. I will review this threat and update it.",
      "parentUuid": "97b2cb9b_43f23c40",
      "range": {
        "startLine": 671,
        "startChar": 27,
        "endLine": 671,
        "endChar": 34
      },
      "revId": "2843394e14be588d05a2b976c9fa6879bddb2cc3",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "0f120750_0b4d2df3",
        "filename": "docs/security/threat_model/threat_assessment.rst",
        "patchSetId": 14
      },
      "lineNbr": 671,
      "author": {
        "id": 1000298
      },
      "writtenOn": "2023-09-12T14:44:42Z",
      "side": 1,
      "message": "I\u0027ve been considering this more in detail and I think that a misconfiguration of the hardware IPs could be a threat on its own, for which it wouldn\u0027t be necessary the existence of another threat agent to launch an attack exploding such vulnerability.\n\nFor cases in which the misconfiguration of the HW IPs can be seen as a vulnerability exploitable by an external threat agent, this could be seen more like bugs on the code, which have already been assessed in this threat model. \n\nSo I think RMMCode should be seen as the Threat Agent for this particular threat, in which misconfiguration of the HW IP can lead to data leaks or incorrect behaviour on its own, even if RMMCode \"threats itself\", if only to raise awareness of DF8 and mitigations for this specific case, although I would like to know Soby\u0027s opinion on this.\n\nI have also reworded this threat description.",
      "parentUuid": "d43f9adf_e1a272bf",
      "range": {
        "startLine": 671,
        "startChar": 27,
        "endLine": 671,
        "endChar": 34
      },
      "revId": "2843394e14be588d05a2b976c9fa6879bddb2cc3",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "941f2a40_9311551e",
        "filename": "docs/security/threat_model/threat_assessment.rst",
        "patchSetId": 14
      },
      "lineNbr": 671,
      "author": {
        "id": 1000056
      },
      "writtenOn": "2023-09-12T15:20:44Z",
      "side": 1,
      "message": "After thinking this for a while, it is likely that issues in RMM are being utilized by a threat  agent outside RMM (Host/realm). So even if RMM does end up configuring hardware IPs wrongly, it could only be exploited from Host or Realm side to force RMM to leak some data.\n\nSo lets keep Realm and Host Software and the threat agent and remove the RmmCode threat actor.",
      "parentUuid": "0f120750_0b4d2df3",
      "range": {
        "startLine": 671,
        "startChar": 27,
        "endLine": 671,
        "endChar": 34
      },
      "revId": "2843394e14be588d05a2b976c9fa6879bddb2cc3",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "2c85fbaf_e8f1d2af",
        "filename": "docs/security/threat_model/threat_assessment.rst",
        "patchSetId": 14
      },
      "lineNbr": 671,
      "author": {
        "id": 1000298
      },
      "writtenOn": "2023-09-13T08:50:40Z",
      "side": 1,
      "message": "Edited as per our discussion.",
      "parentUuid": "941f2a40_9311551e",
      "range": {
        "startLine": 671,
        "startChar": 27,
        "endLine": 671,
        "endChar": 34
      },
      "revId": "2843394e14be588d05a2b976c9fa6879bddb2cc3",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    }
  ]
}