{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "616500cc_57c412f6",
        "filename": "docs/threat_model/dfd.rst",
        "patchSetId": 5
      },
      "lineNbr": 67,
      "author": {
        "id": 1000056
      },
      "writtenOn": "2023-07-24T15:42:01Z",
      "side": 1,
      "message": "\"Interface for RMM-EL3 communication. RMM trusts EL3 and it is part of trusted subsystem, it is out of scope of Threat model for RMM.\"",
      "range": {
        "startLine": 61,
        "startChar": 24,
        "endLine": 67,
        "endChar": 52
      },
      "revId": "6a9476b3dfa2471180e7c08c12e3b0b31c3a06fd",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "3887a1b2_00d83ae6",
        "filename": "docs/threat_model/dfd.rst",
        "patchSetId": 5
      },
      "lineNbr": 79,
      "author": {
        "id": 1000056
      },
      "writtenOn": "2023-07-24T15:42:01Z",
      "side": 1,
      "message": "NS Host",
      "range": {
        "startLine": 79,
        "startChar": 24,
        "endLine": 79,
        "endChar": 37
      },
      "revId": "6a9476b3dfa2471180e7c08c12e3b0b31c3a06fd",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "77ce8e67_873db205",
        "filename": "docs/threat_model/dfd.rst",
        "patchSetId": 5
      },
      "lineNbr": 80,
      "author": {
        "id": 1000056
      },
      "writtenOn": "2023-07-24T15:42:01Z",
      "side": 1,
      "message": "remove.",
      "range": {
        "startLine": 79,
        "startChar": 39,
        "endLine": 80,
        "endChar": 40
      },
      "revId": "6a9476b3dfa2471180e7c08c12e3b0b31c3a06fd",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "3c8f4b96_96b18b50",
        "filename": "docs/threat_model/dfd.rst",
        "patchSetId": 5
      },
      "lineNbr": 81,
      "author": {
        "id": 1000056
      },
      "writtenOn": "2023-07-24T15:42:01Z",
      "side": 1,
      "message": "EL3",
      "range": {
        "startLine": 81,
        "startChar": 52,
        "endLine": 81,
        "endChar": 56
      },
      "revId": "6a9476b3dfa2471180e7c08c12e3b0b31c3a06fd",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "92fa9a81_9cbba369",
        "filename": "docs/threat_model/threat_analysis.rst",
        "patchSetId": 5
      },
      "lineNbr": 28,
      "author": {
        "id": 1000056
      },
      "writtenOn": "2023-07-24T10:16:59Z",
      "side": 1,
      "message": "in Realms or within RMM itself.",
      "range": {
        "startLine": 28,
        "startChar": 71,
        "endLine": 28,
        "endChar": 72
      },
      "revId": "6a9476b3dfa2471180e7c08c12e3b0b31c3a06fd",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "569bdab2_07ae9117",
        "filename": "docs/threat_model/threat_analysis.rst",
        "patchSetId": 5
      },
      "lineNbr": 34,
      "author": {
        "id": 1000056
      },
      "writtenOn": "2023-07-24T10:16:59Z",
      "side": 1,
      "message": "Realms should run only code in R-EL1/EL0 and that no escalation of privilege or code injected by an attacker should run at R-EL2.\n\nAlso, the NS host should not be able inject code into the Realm world by other mechanisms than allowed by the RMM ABI.",
      "range": {
        "startLine": 31,
        "startChar": 27,
        "endLine": 34,
        "endChar": 37
      },
      "revId": "6a9476b3dfa2471180e7c08c12e3b0b31c3a06fd",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "cf8adfd5_06b24def",
        "filename": "docs/threat_model/threat_analysis.rst",
        "patchSetId": 5
      },
      "lineNbr": 37,
      "author": {
        "id": 1000056
      },
      "writtenOn": "2023-07-24T10:16:59Z",
      "side": 1,
      "message": "\"Availability of Realm world is out of scope of threat model for RMM. But Realm and RMM should not affect availability of NS Host nor Secure World.\"",
      "range": {
        "startLine": 36,
        "startChar": 26,
        "endLine": 37,
        "endChar": 71
      },
      "revId": "6a9476b3dfa2471180e7c08c12e3b0b31c3a06fd",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "c1034fed_256b55f2",
        "filename": "docs/threat_model/threat_analysis.rst",
        "patchSetId": 5
      },
      "lineNbr": 53,
      "author": {
        "id": 1000056
      },
      "writtenOn": "2023-07-24T10:16:59Z",
      "side": 1,
      "message": "I think root code is Out of scope for analysis. Move it out of this table and make it part of other out of scope threats.\n\nMalicious or faulty code running at Root Level  (eg: EL3 Firmware). Since RootCode is part of TCB of the system, any fault in Root code is usually critical vulnerability and not easily mitigated by RMM. This Threat is considered out-of-scope of analysis.",
      "range": {
        "startLine": 53,
        "startChar": 26,
        "endLine": 53,
        "endChar": 78
      },
      "revId": "6a9476b3dfa2471180e7c08c12e3b0b31c3a06fd",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "579f4e3e_d1eea7bb",
        "filename": "docs/threat_model/threat_analysis.rst",
        "patchSetId": 5
      },
      "lineNbr": 53,
      "author": {
        "id": 1000056
      },
      "writtenOn": "2023-07-24T10:16:59Z",
      "side": 1,
      "message": "Sorry, I may have given wrong comments last time. This can be \"RootCode\"",
      "range": {
        "startLine": 53,
        "startChar": 6,
        "endLine": 53,
        "endChar": 20
      },
      "revId": "6a9476b3dfa2471180e7c08c12e3b0b31c3a06fd",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "45b38e76_262568a0",
        "filename": "docs/threat_model/threat_analysis.rst",
        "patchSetId": 5
      },
      "lineNbr": 68,
      "author": {
        "id": 1000056
      },
      "writtenOn": "2023-07-24T10:16:59Z",
      "side": 1,
      "message": "using debug build of RMM or access to debug sources of the system.",
      "range": {
        "startLine": 67,
        "startChar": 45,
        "endLine": 68,
        "endChar": 46
      },
      "revId": "6a9476b3dfa2471180e7c08c12e3b0b31c3a06fd",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "09dda7e9_2a65eff8",
        "filename": "docs/threat_model/threat_assessment.rst",
        "patchSetId": 5
      },
      "lineNbr": 51,
      "author": {
        "id": 1000056
      },
      "writtenOn": "2023-07-24T10:16:59Z",
      "side": 1,
      "message": "remove.",
      "range": {
        "startLine": 51,
        "startChar": 37,
        "endLine": 51,
        "endChar": 62
      },
      "revId": "6a9476b3dfa2471180e7c08c12e3b0b31c3a06fd",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "f5a4d007_7777bede",
        "filename": "docs/threat_model/threat_assessment.rst",
        "patchSetId": 5
      },
      "lineNbr": 94,
      "author": {
        "id": 1000056
      },
      "writtenOn": "2023-07-24T10:16:59Z",
      "side": 1,
      "message": "\"..attack on the system by causing the Realm world/RMM to deadlock or enter into an unknown state.\"",
      "range": {
        "startLine": 93,
        "startChar": 36,
        "endLine": 94,
        "endChar": 74
      },
      "revId": "6a9476b3dfa2471180e7c08c12e3b0b31c3a06fd",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "18710bac_e6ab6a44",
        "filename": "docs/threat_model/threat_assessment.rst",
        "patchSetId": 5
      },
      "lineNbr": 97,
      "author": {
        "id": 1000056
      },
      "writtenOn": "2023-07-24T10:16:59Z",
      "side": 1,
      "message": "\"Malicious Host or Realm code can ..",
      "range": {
        "startLine": 97,
        "startChar": 48,
        "endLine": 97,
        "endChar": 62
      },
      "revId": "6a9476b3dfa2471180e7c08c12e3b0b31c3a06fd",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "8ccd5289_214ac8dd",
        "filename": "docs/threat_model/threat_assessment.rst",
        "patchSetId": 5
      },
      "lineNbr": 97,
      "author": {
        "id": 1000056
      },
      "writtenOn": "2023-07-24T10:16:59Z",
      "side": 1,
      "message": "remove.",
      "range": {
        "startLine": 96,
        "startChar": 26,
        "endLine": 97,
        "endChar": 46
      },
      "revId": "6a9476b3dfa2471180e7c08c12e3b0b31c3a06fd",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "eaa2f9c7_5d84cd01",
        "filename": "docs/threat_model/threat_assessment.rst",
        "patchSetId": 5
      },
      "lineNbr": 117,
      "author": {
        "id": 1000056
      },
      "writtenOn": "2023-07-24T10:16:59Z",
      "side": 1,
      "message": "add: \nFollow locking discipline when acquiring locks in RMM.\n\nState transitions should be designed and implemented to avoid RMM entering into invalid state. RMM specification mandates various failure conditions for input arguments. These need to be enforced. Tooling CBMC will help to enforce these rules and validate that RMM can enter into invalid state. Fuzz testing can also be implemented to ensure implementation is robust.",
      "revId": "6a9476b3dfa2471180e7c08c12e3b0b31c3a06fd",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e06ba96e_17e5ba44",
        "filename": "docs/threat_model/threat_assessment.rst",
        "patchSetId": 5
      },
      "lineNbr": 121,
      "author": {
        "id": 1000056
      },
      "writtenOn": "2023-07-24T10:16:59Z",
      "side": 1,
      "message": "\"The RMI and RSI inputs and locking discipline is carefully reviewed as part of implementation. The validation is verified using various tests.\"\n\n\nFor pending actions :\nThe pre-conditions  validation using tools like CBMC. Also add fuzz testing to RMM ABI.",
      "range": {
        "startLine": 121,
        "startChar": 29,
        "endLine": 121,
        "endChar": 78
      },
      "revId": "6a9476b3dfa2471180e7c08c12e3b0b31c3a06fd",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "8f8a2fa1_3c10889d",
        "filename": "docs/threat_model/threat_assessment.rst",
        "patchSetId": 5
      },
      "lineNbr": 130,
      "author": {
        "id": 1000056
      },
      "writtenOn": "2023-07-24T10:16:59Z",
      "side": 1,
      "message": "..using RMM ABI\"",
      "range": {
        "startLine": 130,
        "startChar": 35,
        "endLine": 130,
        "endChar": 44
      },
      "revId": "6a9476b3dfa2471180e7c08c12e3b0b31c3a06fd",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e5f0780f_182bafe1",
        "filename": "docs/threat_model/threat_assessment.rst",
        "patchSetId": 5
      },
      "lineNbr": 132,
      "author": {
        "id": 1000056
      },
      "writtenOn": "2023-07-24T10:16:59Z",
      "side": 1,
      "message": "NS Host as well as",
      "range": {
        "startLine": 132,
        "startChar": 29,
        "endLine": 132,
        "endChar": 42
      },
      "revId": "6a9476b3dfa2471180e7c08c12e3b0b31c3a06fd",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "3cbd6b61_6f6ee313",
        "filename": "docs/threat_model/threat_assessment.rst",
        "patchSetId": 5
      },
      "lineNbr": 135,
      "author": {
        "id": 1000056
      },
      "writtenOn": "2023-07-24T15:42:01Z",
      "side": 1,
      "message": "A realm can claim to be another Realm. NS Host can associate PA of one Realm with another Realm. (Spoofing).\n\n\nMitigated: SMC call from realm is always associated to the Realm Descriptor(RD) and the RMM ABI does not allow spoofing of RD. NS Host always has to sent the valid RD to make requests to the corresponding Realm. RMM maintains a global granule array and every granule linked to a Realm has a specific State and reference count associated with it. Hence the NS Host cannot associate a granule to another Realm and this is part of the RMM ABI.",
      "revId": "6a9476b3dfa2471180e7c08c12e3b0b31c3a06fd",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "dc850673_8d439fef",
        "filename": "docs/threat_model/threat_assessment.rst",
        "patchSetId": 5
      },
      "lineNbr": 137,
      "author": {
        "id": 1000056
      },
      "writtenOn": "2023-07-24T10:16:59Z",
      "side": 1,
      "message": "DF7..smilar comment to any threat attributed to RootCode.",
      "range": {
        "startLine": 137,
        "startChar": 27,
        "endLine": 137,
        "endChar": 30
      },
      "revId": "6a9476b3dfa2471180e7c08c12e3b0b31c3a06fd",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "391ae38f_225227af",
        "filename": "docs/threat_model/threat_assessment.rst",
        "patchSetId": 5
      },
      "lineNbr": 141,
      "author": {
        "id": 1000056
      },
      "writtenOn": "2023-07-24T10:16:59Z",
      "side": 1,
      "message": "NS Host",
      "range": {
        "startLine": 141,
        "startChar": 27,
        "endLine": 141,
        "endChar": 52
      },
      "revId": "6a9476b3dfa2471180e7c08c12e3b0b31c3a06fd",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "c0721b84_0704d500",
        "filename": "docs/threat_model/threat_assessment.rst",
        "patchSetId": 5
      },
      "lineNbr": 154,
      "author": {
        "id": 1000056
      },
      "writtenOn": "2023-07-24T10:16:59Z",
      "side": 1,
      "message": "Ensure RMM protects the Realm memory by using GPT and appropriate Stage 2 protections. CPU registers and system registers should not leak any Realm details to NS host other than what is allowed by the RMM ABI. NS Host must not be able to change or access the memory and CPU registers other than what is allowed by the RMM ABI.\n\nThe RME architecture provides memory isolation to the Realm world. But when delegating memory to the Realm world, RMM needs to ensure that suitable memory scrubbing is implemented. Also RMM should ensure any architectural caches and memory is invalidated before returning back to NS Host.\n\nRMM should also take precautions to ensure prevent any side channel leakage realm execution following the best practices recommended by the Architecture.",
      "range": {
        "startLine": 151,
        "startChar": 27,
        "endLine": 154,
        "endChar": 56
      },
      "revId": "6a9476b3dfa2471180e7c08c12e3b0b31c3a06fd",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "be4ac6c0_4246bf6c",
        "filename": "docs/threat_model/threat_assessment.rst",
        "patchSetId": 5
      },
      "lineNbr": 154,
      "author": {
        "id": 1000056
      },
      "writtenOn": "2023-07-24T12:21:23Z",
      "side": 1,
      "message": "I see that you have a separate threat for side channel, so modifying this comment :\n\nEnsure RMM protects the Realm memory by using GPT and appropriate Stage 2 protections. CPU registers and system registers should not leak any Realm details to NS host other than what is allowed by the RMM ABI. NS Host must not be able to change or access the memory and CPU registers other than what is allowed by the RMM ABI. RMM should perform proper context switching of CPU registers when entering and exiting Realm.\n\nThe RME architecture provides memory isolation to the Realm world. RMM relies on RootCode for correct RME setup. But when delegating memory to the Realm world, RMM needs to ensure that suitable memory scrubbing is implemented. Also RMM should ensure any architectural caches and memory is invalidated before returning back to NS Host.",
      "parentUuid": "c0721b84_0704d500",
      "range": {
        "startLine": 151,
        "startChar": 27,
        "endLine": 154,
        "endChar": 56
      },
      "revId": "6a9476b3dfa2471180e7c08c12e3b0b31c3a06fd",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "bbfeb35f_b41a7792",
        "filename": "docs/threat_model/threat_assessment.rst",
        "patchSetId": 5
      },
      "lineNbr": 160,
      "author": {
        "id": 1000056
      },
      "writtenOn": "2023-07-24T10:16:59Z",
      "side": 1,
      "message": "remove. Many of the threats on side channel and mitigations are evolving and RMM strives to implement the best practices recommended.",
      "range": {
        "startLine": 157,
        "startChar": 28,
        "endLine": 160,
        "endChar": 57
      },
      "revId": "6a9476b3dfa2471180e7c08c12e3b0b31c3a06fd",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "ff3764d7_47439f76",
        "filename": "docs/threat_model/threat_assessment.rst",
        "patchSetId": 5
      },
      "lineNbr": 160,
      "author": {
        "id": 1000056
      },
      "writtenOn": "2023-07-24T12:21:23Z",
      "side": 1,
      "message": "\"Yes\" is enough. \n\nThe side channel is covered in a separate threat.",
      "parentUuid": "bbfeb35f_b41a7792",
      "range": {
        "startLine": 157,
        "startChar": 28,
        "endLine": 160,
        "endChar": 57
      },
      "revId": "6a9476b3dfa2471180e7c08c12e3b0b31c3a06fd",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "2081d922_0a8cf0cc",
        "filename": "docs/threat_model/threat_assessment.rst",
        "patchSetId": 5
      },
      "lineNbr": 165,
      "author": {
        "id": 1000056
      },
      "writtenOn": "2023-07-24T10:16:59Z",
      "side": 1,
      "message": "remove.\n\n\"Keep monitoring evolving threats and hardening code against this threat.\"",
      "range": {
        "startLine": 162,
        "startChar": 27,
        "endLine": 165,
        "endChar": 62
      },
      "revId": "6a9476b3dfa2471180e7c08c12e3b0b31c3a06fd",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "381bbaf3_b8f4bedd",
        "filename": "docs/threat_model/threat_assessment.rst",
        "patchSetId": 5
      },
      "lineNbr": 165,
      "author": {
        "id": 1000056
      },
      "writtenOn": "2023-07-24T12:21:23Z",
      "side": 1,
      "message": "The above comment can be kept in the side channel detail.",
      "parentUuid": "2081d922_0a8cf0cc",
      "range": {
        "startLine": 162,
        "startChar": 27,
        "endLine": 165,
        "endChar": 62
      },
      "revId": "6a9476b3dfa2471180e7c08c12e3b0b31c3a06fd",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "6551aad7_c6397c75",
        "filename": "docs/threat_model/threat_assessment.rst",
        "patchSetId": 5
      },
      "lineNbr": 192,
      "author": {
        "id": 1000056
      },
      "writtenOn": "2023-07-24T12:21:23Z",
      "side": 1,
      "message": "replace with NS Host",
      "range": {
        "startLine": 192,
        "startChar": 26,
        "endLine": 192,
        "endChar": 52
      },
      "revId": "6a9476b3dfa2471180e7c08c12e3b0b31c3a06fd",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "29f01e12_04325c21",
        "filename": "docs/threat_model/threat_assessment.rst",
        "patchSetId": 5
      },
      "lineNbr": 205,
      "author": {
        "id": 1000056
      },
      "writtenOn": "2023-07-24T12:21:23Z",
      "side": 1,
      "message": "4) memory and loop bound validation.",
      "revId": "6a9476b3dfa2471180e7c08c12e3b0b31c3a06fd",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "f55c3586_516e862f",
        "filename": "docs/threat_model/threat_assessment.rst",
        "patchSetId": 5
      },
      "lineNbr": 208,
      "author": {
        "id": 1000056
      },
      "writtenOn": "2023-07-24T12:21:23Z",
      "side": 1,
      "message": "NS Host",
      "range": {
        "startLine": 208,
        "startChar": 48,
        "endLine": 208,
        "endChar": 60
      },
      "revId": "6a9476b3dfa2471180e7c08c12e3b0b31c3a06fd",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "dc9c31ae_04e68c0b",
        "filename": "docs/threat_model/threat_assessment.rst",
        "patchSetId": 5
      },
      "lineNbr": 209,
      "author": {
        "id": 1000056
      },
      "writtenOn": "2023-07-24T12:21:23Z",
      "side": 1,
      "message": "EL3",
      "range": {
        "startLine": 209,
        "startChar": 29,
        "endLine": 209,
        "endChar": 33
      },
      "revId": "6a9476b3dfa2471180e7c08c12e3b0b31c3a06fd",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "a5e2a6b7_87da8dbe",
        "filename": "docs/threat_model/threat_assessment.rst",
        "patchSetId": 5
      },
      "lineNbr": 221,
      "author": {
        "id": 1000056
      },
      "writtenOn": "2023-07-24T12:21:23Z",
      "side": 1,
      "message": "remove.",
      "range": {
        "startLine": 215,
        "startChar": 27,
        "endLine": 221,
        "endChar": 67
      },
      "revId": "6a9476b3dfa2471180e7c08c12e3b0b31c3a06fd",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "d3260c8c_178d8535",
        "filename": "docs/threat_model/threat_assessment.rst",
        "patchSetId": 5
      },
      "lineNbr": 221,
      "author": {
        "id": 1000056
      },
      "writtenOn": "2023-07-24T15:42:01Z",
      "side": 1,
      "message": "Keep this.",
      "parentUuid": "a5e2a6b7_87da8dbe",
      "range": {
        "startLine": 215,
        "startChar": 27,
        "endLine": 221,
        "endChar": 67
      },
      "revId": "6a9476b3dfa2471180e7c08c12e3b0b31c3a06fd",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "0e44788d_7ee01dc5",
        "filename": "docs/threat_model/threat_assessment.rst",
        "patchSetId": 5
      },
      "lineNbr": 230,
      "author": {
        "id": 1000056
      },
      "writtenOn": "2023-07-24T12:21:23Z",
      "side": 1,
      "message": "remove.",
      "range": {
        "startLine": 226,
        "startChar": 63,
        "endLine": 230,
        "endChar": 65
      },
      "revId": "6a9476b3dfa2471180e7c08c12e3b0b31c3a06fd",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e9f4e4a2_1b9e26a8",
        "filename": "docs/threat_model/threat_assessment.rst",
        "patchSetId": 5
      },
      "lineNbr": 230,
      "author": {
        "id": 1000056
      },
      "writtenOn": "2023-07-24T15:42:01Z",
      "side": 1,
      "message": "Panics should return back to EL3 thus keeping the availability of the overall system. EL3 can decide to disable Realm world at this point.",
      "parentUuid": "0e44788d_7ee01dc5",
      "range": {
        "startLine": 226,
        "startChar": 63,
        "endLine": 230,
        "endChar": 65
      },
      "revId": "6a9476b3dfa2471180e7c08c12e3b0b31c3a06fd",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "2a820a45_dc0db85e",
        "filename": "docs/threat_model/threat_assessment.rst",
        "patchSetId": 5
      },
      "lineNbr": 237,
      "author": {
        "id": 1000056
      },
      "writtenOn": "2023-07-24T12:21:23Z",
      "side": 1,
      "message": "RMM makes use of various static analysis tools and other model checkers like CBMC to ensure that bugs in code are caught and fixed. RMM also uses MISRA coding guidelines to remove some of the issues which is considered safer for implementations using C language.",
      "range": {
        "startLine": 233,
        "startChar": 68,
        "endLine": 237,
        "endChar": 59
      },
      "revId": "6a9476b3dfa2471180e7c08c12e3b0b31c3a06fd",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "70c8daba_07782b9f",
        "filename": "docs/threat_model/threat_assessment.rst",
        "patchSetId": 5
      },
      "lineNbr": 239,
      "author": {
        "id": 1000056
      },
      "writtenOn": "2023-07-24T12:21:23Z",
      "side": 1,
      "message": "Incorporate new static analyzers , and CBMC into RMM.",
      "range": {
        "startLine": 239,
        "startChar": 27,
        "endLine": 239,
        "endChar": 38
      },
      "revId": "6a9476b3dfa2471180e7c08c12e3b0b31c3a06fd",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "15d860a5_a431cfc6",
        "filename": "docs/threat_model/threat_assessment.rst",
        "patchSetId": 5
      },
      "lineNbr": 274,
      "author": {
        "id": 1000056
      },
      "writtenOn": "2023-07-24T12:21:23Z",
      "side": 1,
      "message": "remove. This is already part of ID 03 threat.",
      "range": {
        "startLine": 242,
        "startChar": 0,
        "endLine": 274,
        "endChar": 81
      },
      "revId": "6a9476b3dfa2471180e7c08c12e3b0b31c3a06fd",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "f879b026_a96ad6d7",
        "filename": "docs/threat_model/threat_assessment.rst",
        "patchSetId": 5
      },
      "lineNbr": 302,
      "author": {
        "id": 1000056
      },
      "writtenOn": "2023-07-24T12:21:23Z",
      "side": 1,
      "message": "as recommended by the Architecture.",
      "range": {
        "startLine": 302,
        "startChar": 71,
        "endLine": 302,
        "endChar": 72
      },
      "revId": "6a9476b3dfa2471180e7c08c12e3b0b31c3a06fd",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "df4ed7fc_04465fc1",
        "filename": "docs/threat_model/threat_assessment.rst",
        "patchSetId": 5
      },
      "lineNbr": 310,
      "author": {
        "id": 1000056
      },
      "writtenOn": "2023-07-24T12:21:23Z",
      "side": 1,
      "message": "RMM enables some mitigations as mandated by the Architecture.",
      "range": {
        "startLine": 306,
        "startChar": 28,
        "endLine": 310,
        "endChar": 49
      },
      "revId": "6a9476b3dfa2471180e7c08c12e3b0b31c3a06fd",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "1574526b_d7857895",
        "filename": "docs/threat_model/threat_assessment.rst",
        "patchSetId": 5
      },
      "lineNbr": 317,
      "author": {
        "id": 1000056
      },
      "writtenOn": "2023-07-24T12:21:23Z",
      "side": 1,
      "message": "remove.",
      "range": {
        "startLine": 311,
        "startChar": 26,
        "endLine": 317,
        "endChar": 49
      },
      "revId": "6a9476b3dfa2471180e7c08c12e3b0b31c3a06fd",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "324f9dbc_c62302fa",
        "filename": "docs/threat_model/threat_assessment.rst",
        "patchSetId": 5
      },
      "lineNbr": 324,
      "author": {
        "id": 1000056
      },
      "writtenOn": "2023-07-24T12:21:23Z",
      "side": 1,
      "message": "Review speculation vulnerabilities and ensure RMM implements the mitigations.",
      "range": {
        "startLine": 322,
        "startChar": 27,
        "endLine": 324,
        "endChar": 48
      },
      "revId": "6a9476b3dfa2471180e7c08c12e3b0b31c3a06fd",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "7131a509_371d4853",
        "filename": "docs/threat_model/threat_assessment.rst",
        "patchSetId": 5
      },
      "lineNbr": 332,
      "author": {
        "id": 1000056
      },
      "writtenOn": "2023-07-24T12:21:23Z",
      "side": 1,
      "message": "combine this with previous.",
      "range": {
        "startLine": 330,
        "startChar": 0,
        "endLine": 332,
        "endChar": 71
      },
      "revId": "6a9476b3dfa2471180e7c08c12e3b0b31c3a06fd",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "b46f530f_515f77bc",
        "filename": "docs/threat_model/threat_assessment.rst",
        "patchSetId": 5
      },
      "lineNbr": 361,
      "author": {
        "id": 1000056
      },
      "writtenOn": "2023-07-24T12:21:23Z",
      "side": 1,
      "message": "combine with previous.",
      "range": {
        "startLine": 357,
        "startChar": 27,
        "endLine": 361,
        "endChar": 77
      },
      "revId": "6a9476b3dfa2471180e7c08c12e3b0b31c3a06fd",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "bb296a23_800449f7",
        "filename": "docs/threat_model/threat_assessment.rst",
        "patchSetId": 5
      },
      "lineNbr": 365,
      "author": {
        "id": 1000056
      },
      "writtenOn": "2023-07-24T12:21:23Z",
      "side": 1,
      "message": "combine with previous.",
      "range": {
        "startLine": 363,
        "startChar": 29,
        "endLine": 365,
        "endChar": 48
      },
      "revId": "6a9476b3dfa2471180e7c08c12e3b0b31c3a06fd",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "f435d32c_f819743a",
        "filename": "docs/threat_model/threat_assessment.rst",
        "patchSetId": 5
      },
      "lineNbr": 375,
      "author": {
        "id": 1000056
      },
      "writtenOn": "2023-07-24T12:21:23Z",
      "side": 1,
      "message": "This is already enabled I think. Can you check and confirm ?",
      "range": {
        "startLine": 375,
        "startChar": 26,
        "endLine": 375,
        "endChar": 65
      },
      "revId": "6a9476b3dfa2471180e7c08c12e3b0b31c3a06fd",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "7caf6e56_c90e210d",
        "filename": "docs/threat_model/threat_assessment.rst",
        "patchSetId": 5
      },
      "lineNbr": 383,
      "author": {
        "id": 1000056
      },
      "writtenOn": "2023-07-24T12:21:23Z",
      "side": 1,
      "message": "remove. Already covered in previous threats.",
      "range": {
        "startLine": 381,
        "startChar": 0,
        "endLine": 383,
        "endChar": 55
      },
      "revId": "6a9476b3dfa2471180e7c08c12e3b0b31c3a06fd",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "5db3cf93_38034f12",
        "filename": "docs/threat_model/threat_assessment.rst",
        "patchSetId": 5
      },
      "lineNbr": 429,
      "author": {
        "id": 1000056
      },
      "writtenOn": "2023-07-24T12:21:23Z",
      "side": 1,
      "message": "Unexpected boot arguments (including boot manifest) from EL3 firmware  or different format of boot manifest can cause RMM to crash or panic().\n\nIf ``panic()`` is invoked as part of the RMM boot process, either during cold or warm boot paths, the PE might get halted/stalled thus causing Denial of service to other worlds in the system.",
      "range": {
        "startLine": 424,
        "startChar": 27,
        "endLine": 429,
        "endChar": 73
      },
      "revId": "6a9476b3dfa2471180e7c08c12e3b0b31c3a06fd",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "cb32ff1f_53545ef1",
        "filename": "docs/threat_model/threat_assessment.rst",
        "patchSetId": 5
      },
      "lineNbr": 450,
      "author": {
        "id": 1000056
      },
      "writtenOn": "2023-07-24T12:21:23Z",
      "side": 1,
      "message": "RMM and EL3 enforces a strict version control of Boot interface. Any mismatch or incompatible change is caught out by the version change and will cause RMM to fail. RMM also validates the boot arguments as far as possible.\n\nAny boot failure is signaled to RootCode suitably using an SMC which then can take appropriate action (either disable Realm world or reboot the system).",
      "range": {
        "startLine": 445,
        "startChar": 27,
        "endLine": 450,
        "endChar": 48
      },
      "revId": "6a9476b3dfa2471180e7c08c12e3b0b31c3a06fd",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e50be342_ddd67299",
        "filename": "docs/threat_model/threat_assessment.rst",
        "patchSetId": 5
      },
      "lineNbr": 452,
      "author": {
        "id": 1000056
      },
      "writtenOn": "2023-07-24T12:21:23Z",
      "side": 1,
      "message": "platform specific part of the boot protocol needs platform specific mitigation.",
      "range": {
        "startLine": 452,
        "startChar": 36,
        "endLine": 452,
        "endChar": 63
      },
      "revId": "6a9476b3dfa2471180e7c08c12e3b0b31c3a06fd",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "49c42b61_13f5e32a",
        "filename": "docs/threat_model/threat_assessment.rst",
        "patchSetId": 5
      },
      "lineNbr": 459,
      "author": {
        "id": 1000056
      },
      "writtenOn": "2023-07-24T12:21:23Z",
      "side": 1,
      "message": "remove, this is part of pending action.",
      "range": {
        "startLine": 458,
        "startChar": 22,
        "endLine": 459,
        "endChar": 67
      },
      "revId": "6a9476b3dfa2471180e7c08c12e3b0b31c3a06fd",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e6fcb1e2_f3ea2963",
        "filename": "docs/threat_model/threat_assessment.rst",
        "patchSetId": 5
      },
      "lineNbr": 468,
      "author": {
        "id": 1000056
      },
      "writtenOn": "2023-07-24T12:21:23Z",
      "side": 1,
      "message": "remove",
      "range": {
        "startLine": 468,
        "startChar": 62,
        "endLine": 468,
        "endChar": 74
      },
      "revId": "6a9476b3dfa2471180e7c08c12e3b0b31c3a06fd",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "1397b1fe_b82cd581",
        "filename": "docs/threat_model/threat_assessment.rst",
        "patchSetId": 5
      },
      "lineNbr": 475,
      "author": {
        "id": 1000056
      },
      "writtenOn": "2023-07-24T12:21:23Z",
      "side": 1,
      "message": "A misconfiguration of the MMU could lead to an open door for a Realms to access other Realms or even NS Host memory.\n\nEnsure that RMM verified that any PA to be mapped in S2 or S1 belongs to the Realm. If the PA is NS, then the request for mapping the PA must have been send by NS Host.",
      "range": {
        "startLine": 472,
        "startChar": 29,
        "endLine": 475,
        "endChar": 74
      },
      "revId": "6a9476b3dfa2471180e7c08c12e3b0b31c3a06fd",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "dfe78698_b84ea07c",
        "filename": "docs/threat_model/threat_assessment.rst",
        "patchSetId": 5
      },
      "lineNbr": 496,
      "author": {
        "id": 1000056
      },
      "writtenOn": "2023-07-24T12:21:23Z",
      "side": 1,
      "message": "The RMM specification mandates the rules for assigning memory to a Realm and hence the S1 and S2 checks to be performed. Also the access permissions are mandated by the RMM specification.",
      "range": {
        "startLine": 491,
        "startChar": 27,
        "endLine": 496,
        "endChar": 77
      },
      "revId": "6a9476b3dfa2471180e7c08c12e3b0b31c3a06fd",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "b9f9890e_de4b6d4d",
        "filename": "docs/threat_model/threat_assessment.rst",
        "patchSetId": 5
      },
      "lineNbr": 503,
      "author": {
        "id": 1000056
      },
      "writtenOn": "2023-07-24T12:21:23Z",
      "side": 1,
      "message": "\"Yes\"",
      "range": {
        "startLine": 498,
        "startChar": 27,
        "endLine": 503,
        "endChar": 64
      },
      "revId": "6a9476b3dfa2471180e7c08c12e3b0b31c3a06fd",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "9516be96_f475cbf5",
        "filename": "docs/threat_model/threat_assessment.rst",
        "patchSetId": 5
      },
      "lineNbr": 539,
      "author": {
        "id": 1000056
      },
      "writtenOn": "2023-07-24T12:21:23Z",
      "side": 1,
      "message": "remove, covered in previous threat.",
      "range": {
        "startLine": 508,
        "startChar": 0,
        "endLine": 539,
        "endChar": 80
      },
      "revId": "6a9476b3dfa2471180e7c08c12e3b0b31c3a06fd",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "3020778f_48779f0f",
        "filename": "docs/threat_model/threat_assessment.rst",
        "patchSetId": 5
      },
      "lineNbr": 614,
      "author": {
        "id": 1000056
      },
      "writtenOn": "2023-07-24T15:42:01Z",
      "side": 1,
      "message": "Keep AMU outside threat because AMU provides info for scheduling decisions and are very coarse.",
      "range": {
        "startLine": 614,
        "startChar": 36,
        "endLine": 614,
        "endChar": 39
      },
      "revId": "6a9476b3dfa2471180e7c08c12e3b0b31c3a06fd",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "983ed360_98073b00",
        "filename": "docs/threat_model/threat_assessment.rst",
        "patchSetId": 5
      },
      "lineNbr": 632,
      "author": {
        "id": 1000056
      },
      "writtenOn": "2023-07-24T12:21:23Z",
      "side": 1,
      "message": "add: \n\nconfigure MPAM so that is either disabled or set to default values for Realm world.",
      "revId": "6a9476b3dfa2471180e7c08c12e3b0b31c3a06fd",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "20b5c285_253951b2",
        "filename": "docs/threat_model/threat_assessment.rst",
        "patchSetId": 5
      },
      "lineNbr": 634,
      "author": {
        "id": 1000056
      },
      "writtenOn": "2023-07-24T12:21:23Z",
      "side": 1,
      "message": "\"mitigations implemented ?\"",
      "range": {
        "startLine": 634,
        "startChar": 2,
        "endLine": 634,
        "endChar": 14
      },
      "revId": "6a9476b3dfa2471180e7c08c12e3b0b31c3a06fd",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "bc93d65b_27ad946a",
        "filename": "docs/threat_model/threat_assessment.rst",
        "patchSetId": 5
      },
      "lineNbr": 636,
      "author": {
        "id": 1000056
      },
      "writtenOn": "2023-07-24T12:21:23Z",
      "side": 1,
      "message": "PMU is saved and restored. MPAM is not enabled for Realm world.",
      "range": {
        "startLine": 634,
        "startChar": 28,
        "endLine": 636,
        "endChar": 46
      },
      "revId": "6a9476b3dfa2471180e7c08c12e3b0b31c3a06fd",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "3c87675c_1b901e5d",
        "filename": "docs/threat_model/threat_assessment.rst",
        "patchSetId": 5
      },
      "lineNbr": 670,
      "author": {
        "id": 1000056
      },
      "writtenOn": "2023-07-24T12:21:23Z",
      "side": 1,
      "message": "\"Mitigations implemented ?\"",
      "range": {
        "startLine": 670,
        "startChar": 2,
        "endLine": 670,
        "endChar": 14
      },
      "revId": "6a9476b3dfa2471180e7c08c12e3b0b31c3a06fd",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "f0cfa6e7_097ae2e3",
        "filename": "docs/threat_model/threat_assessment.rst",
        "patchSetId": 5
      },
      "lineNbr": 677,
      "author": {
        "id": 1000056
      },
      "writtenOn": "2023-07-24T12:21:23Z",
      "side": 1,
      "message": "can be removed.",
      "range": {
        "startLine": 673,
        "startChar": 50,
        "endLine": 677,
        "endChar": 59
      },
      "revId": "6a9476b3dfa2471180e7c08c12e3b0b31c3a06fd",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "c445ab13_ada6993a",
        "filename": "docs/threat_model/threat_assessment.rst",
        "patchSetId": 5
      },
      "lineNbr": 678,
      "author": {
        "id": 1000056
      },
      "writtenOn": "2023-07-24T12:21:23Z",
      "side": 1,
      "message": "to test for various security properties.",
      "range": {
        "startLine": 677,
        "startChar": 60,
        "endLine": 678,
        "endChar": 46
      },
      "revId": "6a9476b3dfa2471180e7c08c12e3b0b31c3a06fd",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    }
  ]
}