{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "27ba53f3_413faeb3",
        "filename": "/COMMIT_MSG",
        "patchSetId": 5
      },
      "lineNbr": 18,
      "author": {
        "id": 1001079
      },
      "writtenOn": "2023-10-06T13:21:17Z",
      "side": 1,
      "message": "AFAIU, this is intentional. The host is permitted to destroy a s2 translation table when the table holds the references to physical addresses.",
      "range": {
        "startLine": 17,
        "startChar": 0,
        "endLine": 18,
        "endChar": 48
      },
      "revId": "eb72ec99daae3823b0be554589ba837c79da203e",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "bb82f9a0_6b3dfd43",
        "filename": "/COMMIT_MSG",
        "patchSetId": 5
      },
      "lineNbr": 18,
      "author": {
        "id": 1000298
      },
      "writtenOn": "2023-10-06T20:12:47Z",
      "side": 1,
      "message": "Yes, this is from a previous patchset. I forgot removing this from the commit message later.",
      "parentUuid": "27ba53f3_413faeb3",
      "range": {
        "startLine": 17,
        "startChar": 0,
        "endLine": 18,
        "endChar": 48
      },
      "revId": "eb72ec99daae3823b0be554589ba837c79da203e",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "733b5de2_72dbd426",
        "filename": "lib/realm/src/s2tt.c",
        "patchSetId": 5
      },
      "lineNbr": 68,
      "author": {
        "id": 1001079
      },
      "writtenOn": "2023-10-06T13:21:17Z",
      "side": 1,
      "message": "It defines the host\u0027s controlled fields in unprotected (NS) s2ttes and the name should probably reflect that, e.g.:\nS2TTE_HOST_NS_ATTR_MASK",
      "range": {
        "startLine": 68,
        "startChar": 8,
        "endLine": 68,
        "endChar": 24
      },
      "revId": "eb72ec99daae3823b0be554589ba837c79da203e",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "b6cb0d13_5529d497",
        "filename": "lib/realm/src/s2tt.c",
        "patchSetId": 5
      },
      "lineNbr": 68,
      "author": {
        "id": 1000298
      },
      "writtenOn": "2023-10-06T20:12:47Z",
      "side": 1,
      "message": "ACK. I\u0027ll change the name.\n\nWRT the inclusion of S2TTE_AF, this is not needed here, actually (the spec only takes into account memattr, ap, sh, and the addr).\n\nAs part of a later patch rebased on top of this one, which enables LPA2, I needed a mask for all the attributes on an S2TTE. I think I got them mixed up here doing the rebase.",
      "parentUuid": "733b5de2_72dbd426",
      "range": {
        "startLine": 68,
        "startChar": 8,
        "endLine": 68,
        "endChar": 24
      },
      "revId": "eb72ec99daae3823b0be554589ba837c79da203e",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "9d5a16dc_19978a8a",
        "filename": "lib/realm/src/s2tt.c",
        "patchSetId": 5
      },
      "lineNbr": 69,
      "author": {
        "id": 1001079
      },
      "writtenOn": "2023-10-06T13:21:17Z",
      "side": 1,
      "message": "With this change, the host now also controls the access flag (AF). This hasn\u0027t been reflected in the comments below, e.g. see line 877",
      "range": {
        "startLine": 69,
        "startChar": 21,
        "endLine": 69,
        "endChar": 29
      },
      "revId": "eb72ec99daae3823b0be554589ba837c79da203e",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "1df38c0b_c8e1ff2d",
        "filename": "lib/realm/src/s2tt.c",
        "patchSetId": 5
      },
      "lineNbr": 69,
      "author": {
        "id": 1000298
      },
      "writtenOn": "2023-10-06T20:12:47Z",
      "side": 1,
      "message": "Fixed as per my comment above.",
      "parentUuid": "9d5a16dc_19978a8a",
      "range": {
        "startLine": 69,
        "startChar": 21,
        "endLine": 69,
        "endChar": 29
      },
      "revId": "eb72ec99daae3823b0be554589ba837c79da203e",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "c52e0074_de4af757",
        "filename": "lib/realm/src/s2tt.c",
        "patchSetId": 5
      },
      "lineNbr": 74,
      "author": {
        "id": 1001079
      },
      "writtenOn": "2023-10-06T13:21:17Z",
      "side": 1,
      "message": "If the flag is now controlled by the host, shouldn\u0027t it be removed from here?",
      "range": {
        "startLine": 74,
        "startChar": 46,
        "endLine": 74,
        "endChar": 54
      },
      "revId": "eb72ec99daae3823b0be554589ba837c79da203e",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "5d129ad3_557b9f4b",
        "filename": "lib/realm/src/s2tt.c",
        "patchSetId": 5
      },
      "lineNbr": 74,
      "author": {
        "id": 1000298
      },
      "writtenOn": "2023-10-06T20:12:47Z",
      "side": 1,
      "message": "Not needed. See my comment above.",
      "parentUuid": "c52e0074_de4af757",
      "range": {
        "startLine": 74,
        "startChar": 46,
        "endLine": 74,
        "endChar": 54
      },
      "revId": "eb72ec99daae3823b0be554589ba837c79da203e",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "a21888f4_b7f1590c",
        "filename": "lib/realm/src/s2tt.c",
        "patchSetId": 5
      },
      "lineNbr": 75,
      "author": {
        "id": 1001079
      },
      "writtenOn": "2023-10-06T13:21:17Z",
      "side": 1,
      "message": "As above",
      "range": {
        "startLine": 75,
        "startChar": 45,
        "endLine": 75,
        "endChar": 53
      },
      "revId": "eb72ec99daae3823b0be554589ba837c79da203e",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "6ffd6d32_ec821b61",
        "filename": "lib/realm/src/s2tt.c",
        "patchSetId": 5
      },
      "lineNbr": 75,
      "author": {
        "id": 1000298
      },
      "writtenOn": "2023-10-06T20:12:47Z",
      "side": 1,
      "message": "Not needed. See my comment above.",
      "parentUuid": "a21888f4_b7f1590c",
      "range": {
        "startLine": 75,
        "startChar": 45,
        "endLine": 75,
        "endChar": 53
      },
      "revId": "eb72ec99daae3823b0be554589ba837c79da203e",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "8a629a61_928e7881",
        "filename": "lib/realm/src/s2tt.c",
        "patchSetId": 5
      },
      "lineNbr": 501,
      "author": {
        "id": 1001079
      },
      "writtenOn": "2023-10-06T13:21:17Z",
      "side": 1,
      "message": "... and AF",
      "range": {
        "startLine": 501,
        "startChar": 5,
        "endLine": 501,
        "endChar": 17
      },
      "revId": "eb72ec99daae3823b0be554589ba837c79da203e",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "f8125972_ef11320c",
        "filename": "lib/realm/src/s2tt.c",
        "patchSetId": 5
      },
      "lineNbr": 501,
      "author": {
        "id": 1000298
      },
      "writtenOn": "2023-10-06T20:12:47Z",
      "side": 1,
      "message": "Not needed as per my comment above.",
      "parentUuid": "8a629a61_928e7881",
      "range": {
        "startLine": 501,
        "startChar": 5,
        "endLine": 501,
        "endChar": 17
      },
      "revId": "eb72ec99daae3823b0be554589ba837c79da203e",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "adcb3b55_8ebdc348",
        "filename": "lib/realm/src/s2tt.c",
        "patchSetId": 5
      },
      "lineNbr": 505,
      "author": {
        "id": 1001079
      },
      "writtenOn": "2023-10-06T13:21:17Z",
      "side": 1,
      "message": "Why removing only this flag when the comment says that the caller provides the other four?\n\nEither assert against all fields:\nassert(!(s2tte \u0026 ~(S2TTE_ATTRS_MASK | pa_mask(level));\n\n...or don\u0027t do any check.\n\nIt also seems that this function is called from rtt.c with all fields from the parent entry, not just these four from the list.",
      "range": {
        "startLine": 505,
        "startChar": 0,
        "endLine": 505,
        "endChar": 2
      },
      "revId": "eb72ec99daae3823b0be554589ba837c79da203e",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "3596fc79_bd162c1d",
        "filename": "lib/realm/src/s2tt.c",
        "patchSetId": 5
      },
      "lineNbr": 505,
      "author": {
        "id": 1000298
      },
      "writtenOn": "2023-10-06T20:12:47Z",
      "side": 1,
      "message": "Yes, this is buggy. Fixed.",
      "parentUuid": "adcb3b55_8ebdc348",
      "range": {
        "startLine": 505,
        "startChar": 0,
        "endLine": 505,
        "endChar": 2
      },
      "revId": "eb72ec99daae3823b0be554589ba837c79da203e",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "f3952c60_b52bf44b",
        "filename": "lib/realm/src/s2tt.c",
        "patchSetId": 5
      },
      "lineNbr": 900,
      "author": {
        "id": 1001079
      },
      "writtenOn": "2023-10-06T13:21:17Z",
      "side": 1,
      "message": "Can you limit parent_s2tte argument to \"the host\u0027s controlled fields\"?\nThe term \"parent_s2tte\" describe a likely usage but it is ambiguous in this interface.",
      "range": {
        "startLine": 900,
        "startChar": 48,
        "endLine": 900,
        "endChar": 74
      },
      "revId": "eb72ec99daae3823b0be554589ba837c79da203e",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "e5ad08a2_bdd13092",
        "filename": "lib/realm/src/s2tt.c",
        "patchSetId": 5
      },
      "lineNbr": 900,
      "author": {
        "id": 1000298
      },
      "writtenOn": "2023-10-06T20:12:47Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "f3952c60_b52bf44b",
      "range": {
        "startLine": 900,
        "startChar": 48,
        "endLine": 900,
        "endChar": 74
      },
      "revId": "eb72ec99daae3823b0be554589ba837c79da203e",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "bbbd31e2_6fe8c557",
        "filename": "lib/realm/src/s2tt.c",
        "patchSetId": 5
      },
      "lineNbr": 1115,
      "author": {
        "id": 1001079
      },
      "writtenOn": "2023-10-06T13:21:17Z",
      "side": 1,
      "message": "Strictly speaking, the function checks that: \n- all attributes that are controlled by the host are identical.",
      "range": {
        "startLine": 1115,
        "startChar": 8,
        "endLine": 1115,
        "endChar": 57
      },
      "revId": "eb72ec99daae3823b0be554589ba837c79da203e",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "8ef70478_cb0eb82e",
        "filename": "lib/realm/src/s2tt.c",
        "patchSetId": 5
      },
      "lineNbr": 1115,
      "author": {
        "id": 1000298
      },
      "writtenOn": "2023-10-06T20:12:47Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "bbbd31e2_6fe8c557",
      "range": {
        "startLine": 1115,
        "startChar": 8,
        "endLine": 1115,
        "endChar": 57
      },
      "revId": "eb72ec99daae3823b0be554589ba837c79da203e",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "3b84c774_f2a2a329",
        "filename": "runtime/rmi/rtt.c",
        "patchSetId": 5
      },
      "lineNbr": 364,
      "author": {
        "id": 1001079
      },
      "writtenOn": "2023-10-06T13:38:05Z",
      "side": 1,
      "message": "It is obvious that we can just copy SH, AF, MEM.ATTR \u0026 PERMS from parent table.\nIt is less obvious that we can do the same with PA without further alignment so a comment here would be useful, e.g.:\n\n/*\n * We can safely copy the PA from the first entry in \u0027table\u0027 because that PA is aligned\n * to the level below (`level`- 1), as, otherwise, `table_maps_assigned_ns_block_with_attrs` would have failed.\n */",
      "range": {
        "startLine": 364,
        "startChar": 43,
        "endLine": 364,
        "endChar": 48
      },
      "revId": "eb72ec99daae3823b0be554589ba837c79da203e",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "9756afce_746bcefe",
        "filename": "runtime/rmi/rtt.c",
        "patchSetId": 5
      },
      "lineNbr": 364,
      "author": {
        "id": 1001079
      },
      "writtenOn": "2023-10-06T13:38:05Z",
      "side": 1,
      "message": "This is undocumented use of this primitive as here we pass ALL fields.\nCan we remove everything else except: PA, SH, AF, MEM.ATTR \u0026 PERMS)?",
      "range": {
        "startLine": 364,
        "startChar": 18,
        "endLine": 364,
        "endChar": 42
      },
      "revId": "eb72ec99daae3823b0be554589ba837c79da203e",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "9b16bf56_e2fb1274",
        "filename": "runtime/rmi/rtt.c",
        "patchSetId": 5
      },
      "lineNbr": 364,
      "author": {
        "id": 1001127
      },
      "writtenOn": "2023-10-06T14:52:14Z",
      "side": 1,
      "message": "Why aren\u0027t we dropping the refcount on the parent table ? We created a block mapping, which is not refcounted. Only RTTs are refcounted in the unprotected IPA space.",
      "revId": "eb72ec99daae3823b0be554589ba837c79da203e",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "9974c506_c0b68b33",
        "filename": "runtime/rmi/rtt.c",
        "patchSetId": 5
      },
      "lineNbr": 364,
      "author": {
        "id": 1000298
      },
      "writtenOn": "2023-10-06T20:12:47Z",
      "side": 1,
      "message": "s2tte_create_assigned_ns() already masks out any attribute/field that is not needed. I updated the documentation on that function.",
      "parentUuid": "9756afce_746bcefe",
      "range": {
        "startLine": 364,
        "startChar": 18,
        "endLine": 364,
        "endChar": 42
      },
      "revId": "eb72ec99daae3823b0be554589ba837c79da203e",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "5f2a1752_15afd4ae",
        "filename": "runtime/rmi/rtt.c",
        "patchSetId": 5
      },
      "lineNbr": 364,
      "author": {
        "id": 1000298
      },
      "writtenOn": "2023-10-06T20:12:47Z",
      "side": 1,
      "message": "Tests were failing when dropping the refcount on the parent as sometimes it was already zero. Your comment made me realize that the issue wasn\u0027t here, but on smc_rtt_create(), as it needs to increase the refcount on the parent every time a new ns rtt is created. It is fixed now.",
      "parentUuid": "9b16bf56_e2fb1274",
      "revId": "eb72ec99daae3823b0be554589ba837c79da203e",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "28ab9d20_93ef333f",
        "filename": "runtime/rmi/rtt.c",
        "patchSetId": 5
      },
      "lineNbr": 364,
      "author": {
        "id": 1000298
      },
      "writtenOn": "2023-10-06T20:12:47Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "3b84c774_f2a2a329",
      "range": {
        "startLine": 364,
        "startChar": 43,
        "endLine": 364,
        "endChar": 48
      },
      "revId": "eb72ec99daae3823b0be554589ba837c79da203e",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    }
  ]
}